<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tamil Learning App</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#4f46e5">

  <style>
    body{font-family:Arial,sans-serif;background:#f5f7fa;display:flex;justify-content:center;align-items:center;height:100vh;margin:0}
    .app{background:#fff;padding:20px;border-radius:14px;width:380px;box-shadow:0 10px 25px rgba(0,0,0,.1);text-align:center}
    h1{font-size:20px;margin-bottom:10px}
    p{font-size:14px;color:#555}
    .hidden{display:none}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:15px}
    .btn{padding:14px;border:none;border-radius:12px;color:#fff;font-size:16px;cursor:pointer}
    .animals{background:#4f46e5}.birds{background:#0284c7}.fruits{background:#16a34a}
    .verbs{background:#ca8a04}.household{background:#0f766e}.grocery{background:#7c3aed}
    .synonyms{background:#9333ea}.antonyms{background:#0ea5e9}
    .card{height:160px;background:#4f46e5;color:#fff;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:28px;cursor:pointer;margin:12px 0}
    .inner{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .6s}
    .inner.flipped{transform:rotateY(180deg)}
    .side{position:absolute;width:100%;height:100%;backface-visibility:hidden;display:flex;align-items:center;justify-content:center;padding:10px}
    .back{background:#16a34a;transform:rotateY(180deg);font-size:22px}
    .fc-nav{display:flex;justify-content:space-between;margin-top:10px}
    .options{display:flex;flex-direction:column;gap:10px;margin:14px 0}
    .opt{padding:10px;border-radius:8px;border:1px solid #c7d2fe;background:#eef2ff;color:#1f2937;cursor:pointer}
    .correct{background:#bbf7d0;color:#065f46}
    .wrong{background:#fecaca;color:#7f1d1d}
    .quiz-nav{display:flex;justify-content:space-between;margin-top:12px}
    button{padding:8px 14px;border:none;border-radius:8px;background:#4f46e5;color:#fff;cursor:pointer}
    #speak,#speakQuiz{margin:10px 0;background:#9ca3af}
  </style>
</head>
<body>
<div class="app">

<!-- HOME -->
<div id="home">
  <h1>üìò Tamil Learning</h1>
  <p>Select a category</p>
  <div class="grid">
    <button class="btn animals" onclick="selectCategory('animals')">üêæ Animals</button>
    <button class="btn birds" onclick="selectCategory('birds')">üê¶ Birds</button>
    <button class="btn fruits" onclick="selectCategory('fruits')">üçé Fruits</button>
    <button class="btn verbs" onclick="selectCategory('verbs')">üèÉ Verbs</button>
    <button class="btn household" onclick="selectCategory('household')">üè† Household</button>
    <button class="btn grocery" onclick="selectCategory('grocery')">üõí Grocery</button>
    <button class="btn synonyms" onclick="selectRelation('synonyms')">üîÅ Synonyms</button>
    <button class="btn antonyms" onclick="selectRelation('antonyms')">üîÄ Antonyms</button>
  </div>
</div>

<!-- MODE -->
<div id="mode" class="hidden">
  <h1 id="modeTitle"></h1>
  <p>Select learning mode</p>
  <div class="grid">
    <button class="btn animals" onclick="startFlashcards()">üÉè Flashcards</button>
    <button class="btn birds" onclick="startQuiz()">üß† Quiz</button>
  </div>
  <button style="margin-top:12px" onclick="goHome()">‚¨Ö Home</button>
</div>

<!-- FLASHCARDS -->
<div id="flash" class="hidden">
  <h1 id="flashTitle"></h1>
  <button id="speak">üîä Listen</button>
  <div class="card" onclick="flipCard()">
    <div class="inner" id="cardInner">
      <div class="side" id="front"></div>
      <div class="side back" id="back"></div>
    </div>
  </div>
  <div class="fc-nav">
    <button onclick="prev()">Previous</button>
    <button onclick="next()">Next</button>
  </div>
  <p id="counter"></p>
  <button onclick="goHome()">‚¨Ö Home</button>
</div>

<!-- QUIZ -->
<div id="quiz" class="hidden">
  <h1 id="quizTitle"></h1>
  <div id="question" style="font-size:26px;margin:14px 0"></div>
  <button id="speakQuiz">üîä Listen</button>
  <div class="options" id="options"></div>
  <div class="quiz-nav">
    <button onclick="goHome()">‚¨Ö Home</button>
    <button onclick="nextQuiz()">Next ‚û°</button>
  </div>
  <p id="quizCounter"></p>
</div>

</div>

<script>
// ===== DATA =====
const DATA={
 animals:['‡Æ®‡Ææ‡ÆØ‡Øç|Dog','‡Æ™‡ØÇ‡Æ©‡Øà|Cat','‡ÆØ‡Ææ‡Æ©‡Øà|Elephant','‡Æö‡Æø‡Æô‡Øç‡Æï‡ÆÆ‡Øç|Lion','‡Æ™‡ØÅ‡Æ≤‡Æø|Tiger','‡ÆÆ‡Ææ‡Æü‡ØÅ|Cow','‡Æï‡ØÅ‡Æ§‡Æø‡Æ∞‡Øà|Horse','‡ÆÜ‡Æü‡ØÅ|Goat','‡Æö‡ØÜ‡ÆÆ‡Øç‡ÆÆ‡Æ±‡Æø‡ÆØ‡Ææ‡Æü‡ØÅ|Sheep','‡Æï‡ØÅ‡Æ∞‡Æô‡Øç‡Æï‡ØÅ|Monkey','‡Æï‡Æ∞‡Æü‡Æø|Bear','‡Æ®‡Æ∞‡Æø|Fox','‡ÆÆ‡Ææ‡Æ©‡Øç|Deer','‡Æí‡Æü‡Øç‡Æü‡Æï‡ÆÆ‡Øç|Camel','‡Æ™‡Æ©‡Øç‡Æ±‡Æø|Pig','‡Æé‡Æ≤‡Æø|Mouse','‡ÆÆ‡ØÅ‡ÆØ‡Æ≤‡Øç|Rabbit','‡Æ®‡ØÄ‡Æ∞‡Øç‡ÆØ‡Ææ‡Æ©‡Øà|Hippopotamus','‡ÆÆ‡ØÅ‡Æ§‡Æ≤‡Øà|Crocodile','‡Æ™‡Ææ‡ÆÆ‡Øç‡Æ™‡ØÅ|Snake'],
 birds:['‡Æï‡Ææ‡Æï‡ÆÆ‡Øç|Crow','‡Æï‡Æø‡Æ≥‡Æø|Parrot','‡ÆÆ‡ÆØ‡Æø‡Æ≤‡Øç|Peacock','‡Æö‡Æø‡Æü‡Øç‡Æü‡ØÅ‡Æï‡Øç‡Æï‡ØÅ‡Æ∞‡ØÅ‡Æµ‡Æø|Sparrow','‡ÆÜ‡Æ®‡Øç‡Æ§‡Øà|Owl','‡Æ™‡ØÅ‡Æ±‡Ææ|Pigeon','‡Æµ‡Ææ‡Æ§‡Øç‡Æ§‡ØÅ|Duck','‡Æï‡Øã‡Æ¥‡Æø|Hen','‡Æö‡Øá‡Æµ‡Æ≤‡Øç|Rooster','‡Æï‡ØÅ‡ÆØ‡Æø‡Æ≤‡Øç|Cuckoo','‡Æ™‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ|Eagle','‡Æï‡Æ¥‡ØÅ‡Æï‡ØÅ|Vulture','‡Æ®‡Ææ‡Æ∞‡Øà|Stork','‡ÆÆ‡ØÄ‡Æ©‡Øç‡Æï‡Øä‡Æ§‡Øç‡Æ§‡Æø|Kingfisher','‡ÆÖ‡Æ©‡Øç‡Æ©‡ÆÆ‡Øç|Swan','‡Æµ‡Ææ‡Æ©‡Øç‡Æï‡Øã‡Æ¥‡Æø|Turkey','‡Æ™‡ØÜ‡Æ©‡Øç‡Æï‡ØÅ‡ÆØ‡Æø‡Æ©‡Øç|Penguin','‡Æ§‡ØÅ‡ÆÆ‡Øç‡Æ™‡Æø|Bulbul','‡ÆÆ‡Øà‡Æ©‡Ææ|Myna','‡Æ®‡Ææ‡Æ∞‡Øà‡ÆÆ‡ØÇ‡Æï‡Øç‡Æï‡ØÅ|Crane'],
 fruits:['‡ÆÜ‡Æ™‡Øç‡Æ™‡Æø‡Æ≥‡Øç|Apple','‡Æµ‡Ææ‡Æ¥‡Øà‡Æ™‡Øç‡Æ™‡Æ¥‡ÆÆ‡Øç|Banana','‡ÆÆ‡Ææ‡ÆÆ‡Øç‡Æ™‡Æ¥‡ÆÆ‡Øç|Mango','‡Æ§‡Æø‡Æ∞‡Ææ‡Æü‡Øç‡Æö‡Øà|Grapes','‡ÆÜ‡Æ∞‡Æû‡Øç‡Æö‡ØÅ|Orange','‡Æé‡Æ≤‡ØÅ‡ÆÆ‡Æø‡Æö‡Øç‡Æö‡Øà|Lemon','‡Æ™‡Æ™‡Øç‡Æ™‡Ææ‡Æ≥‡Æø|Papaya','‡Æï‡Øä‡ÆØ‡Øç‡ÆØ‡Ææ|Guava','‡ÆÆ‡Ææ‡Æ§‡ØÅ‡Æ≥‡Øà|Pomegranate','‡ÆÖ‡Æ©‡Øç‡Æ©‡Ææ‡Æö‡Æø|Pineapple','‡Æ∏‡Øç‡Æü‡Øç‡Æ∞‡Ææ‡Æ™‡ØÜ‡Æ∞‡Æø|Strawberry','‡Æ™‡Øá‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Ææ‡ÆØ‡Øç|Pear','‡Æö‡Æ™‡Øç‡Æ™‡Øã‡Æü‡Øç‡Æü‡Ææ|Sapota','‡Æ®‡Ææ‡Æµ‡Æ±‡Øç‡Æ™‡Æ¥‡ÆÆ‡Øç|Jamun','‡ÆÜ‡ÆÆ‡Æ£‡Æï‡Øç‡Æï‡ØÅ|Fig','‡Æ™‡Æø‡Æ≥‡ÆÆ‡Øç|Plum','‡Æö‡ØÜ‡Æ∞‡Øç‡Æ∞‡Æø|Cherry','‡Æ™‡ØÄ‡Æö‡Øç|Peach','‡Æ™‡Øá‡Æ∞‡Æø‡Æö‡Øç‡Æö‡Øà|Date','‡Æï‡Æø‡Æµ‡Æø|Kiwi'],
 verbs:['‡Æ™‡Æü‡Æø|Read','‡Æé‡Æ¥‡ØÅ‡Æ§‡ØÅ|Write','‡Æì‡Æü‡ØÅ|Run','‡Æ®‡Æü|Walk','‡Æö‡Ææ‡Æ™‡Øç‡Æ™‡Æø‡Æü‡ØÅ|Eat','‡Æï‡ØÅ‡Æü‡Æø|Drink','‡Æ™‡Øá‡Æö‡ØÅ|Speak','‡Æï‡Øá‡Æ≥‡Øç|Listen','‡Æ™‡Ææ‡Æ∞‡Øç|See','‡Æé‡Æü‡ØÅ|Take','‡Æï‡Øä‡Æü‡ØÅ|Give','‡Æµ‡Ææ|Come','‡Æ™‡Øã|Go','‡Æâ‡Æü‡Øç‡Æï‡Ææ‡Æ∞‡Øç|Sit','‡Æ®‡Æø‡Æ≤‡Øç|Stand','‡Æ§‡ØÇ‡Æô‡Øç‡Æï‡ØÅ|Sleep','‡Æé‡Æ¥‡ØÅ|Wake','‡Æµ‡Æø‡Æ≥‡Øà‡ÆØ‡Ææ‡Æü‡ØÅ|Play','‡Æµ‡Øá‡Æ≤‡Øà‡Æö‡ØÜ‡ÆØ‡Øç|Work','‡Æö‡Æø‡Æ®‡Øç‡Æ§‡Æø|Think'],
 household:['‡ÆÆ‡Øá‡Æú‡Øà|Table','‡Æ®‡Ææ‡Æ±‡Øç‡Æï‡Ææ‡Æ≤‡Æø|Chair','‡Æï‡Æü‡Øç‡Æü‡Æø‡Æ≤‡Øç|Bed','‡ÆÖ‡Æ≤‡ÆÆ‡Ææ‡Æ∞‡Æø|Cupboard','‡Æï‡Æ§‡Æµ‡ØÅ|Door','‡Æú‡Æ©‡Øç‡Æ©‡Æ≤‡Øç|Window','‡Æµ‡Æø‡Æ≥‡Æï‡Øç‡Æï‡ØÅ|Lamp','‡ÆÆ‡Æø‡Æ©‡Øç‡Æµ‡Æø‡Æö‡Æø‡Æ±‡Æø|Fan','‡Æü‡Æø‡Æµ‡Æø|Television','‡ÆÉ‡Æ™‡Øç‡Æ∞‡Æø‡Æü‡Øç‡Æú‡Øç|Refrigerator','‡ÆÖ‡Æü‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ|Stove','‡Æ™‡Ææ‡Æ§‡Øç‡Æ§‡Æø‡Æ∞‡ÆÆ‡Øç|Vessel','‡Æï‡Æ∞‡Æ£‡Øç‡Æü‡Æø|Spoon','‡Æ§‡Æü‡Øç‡Æü‡ØÅ|Plate','‡Æï‡Æø‡Æ£‡Øç‡Æ£‡ÆÆ‡Øç|Bowl','‡Æ§‡ØÅ‡Æü‡Øà‡Æ™‡Øç‡Æ™‡ÆÆ‡Øç|Broom','‡Æï‡Æü‡Æø‡Æï‡Ææ‡Æ∞‡ÆÆ‡Øç|Clock','‡Æ§‡Æ≤‡Øà‡ÆØ‡Æ£‡Øà|Pillow','‡Æ™‡Øã‡Æ∞‡Øç‡Æµ‡Øà|Blanket','‡Æ§‡Øä‡Æ≤‡Øà‡Æ™‡Øá‡Æö‡Æø|Telephone'],
 grocery:['‡ÆÖ‡Æ∞‡Æø‡Æö‡Æø|Rice','‡Æï‡Øã‡Æ§‡ØÅ‡ÆÆ‡Øà|Wheat','‡Æö‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æ∞‡Øà|Sugar','‡Æâ‡Æ™‡Øç‡Æ™‡ØÅ|Salt','‡Æé‡Æ£‡Øç‡Æ£‡ØÜ‡ÆØ‡Øç|Oil','‡Æ™‡Ææ‡Æ≤‡Øç|Milk','‡Æ§‡ÆØ‡Æø‡Æ∞‡Øç|Curd','‡Æµ‡ØÜ‡Æ£‡Øç‡Æ£‡ØÜ‡ÆØ‡Øç|Butter','‡ÆÆ‡ØÅ‡Æü‡Øç‡Æü‡Øà|Egg','‡Æ™‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ|Lentils','‡Æï‡Æü‡Æ≤‡Øà|Peanut','‡Æ™‡Ææ‡Æö‡Æø‡Æ™‡Øç‡Æ™‡ÆØ‡Æ±‡ØÅ|Green gram','‡Æâ‡Æ∞‡ØÅ‡Æ≥‡Øà‡Æï‡Øç‡Æï‡Æø‡Æ¥‡Æô‡Øç‡Æï‡ØÅ|Potato','‡Æµ‡ØÜ‡Æô‡Øç‡Æï‡Ææ‡ÆØ‡ÆÆ‡Øç|Onion','‡Æ§‡Æï‡Øç‡Æï‡Ææ‡Æ≥‡Æø|Tomato','‡ÆÆ‡Æø‡Æ≥‡Æï‡Ææ‡ÆØ‡Øç|Chilli','‡ÆÆ‡Æû‡Øç‡Æö‡Æ≥‡Øç|Turmeric','‡ÆÆ‡Æø‡Æ≥‡Æï‡ØÅ|Pepper','‡Æö‡ØÄ‡Æ∞‡Æï‡ÆÆ‡Øç|Cumin','‡Æï‡Øä‡Æ§‡Øç‡Æ§‡ÆÆ‡Æ≤‡Øç‡Æ≤‡Æø|Coriander']
};

// ===== WORD RELATIONS DATA (20 WORDS) =====
const WORD_RELATIONS = [
  {
    ta: "‡Æ™‡ØÜ‡Æ∞‡Æø‡ÆØ‡Æ§‡ØÅ",
    en: "Big",
    synonyms: { ta: ["‡Æµ‡Æø‡Æö‡Ææ‡Æ≤‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ", "‡ÆÆ‡Æø‡Æï‡Æ™‡Øç‡Æ™‡ØÜ‡Æ∞‡Æø‡ÆØ‡Æ§‡ØÅ"], en: ["Large", "Huge"] },
    antonyms: { ta: ["‡Æö‡Æø‡Æ±‡Æø‡ÆØ‡Æ§‡ØÅ"], en: ["Small"] }
  },
  {
    ta: "‡Æµ‡Øá‡Æï‡ÆÆ‡Ææ‡Æï",
    en: "Fast",
    synonyms: { ta: ["‡ÆÖ‡Æ§‡Æø‡Æµ‡Øá‡Æï‡ÆÆ‡Ææ‡Æï"], en: ["Quick"] },
    antonyms: { ta: ["‡ÆÆ‡ØÜ‡Æ§‡ØÅ‡Æµ‡Ææ‡Æï"], en: ["Slow"] }
  },
  {
    ta: "‡Æö‡ØÅ‡Æ§‡Øç‡Æ§‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Clean",
    synonyms: { ta: ["‡Æ§‡ØÇ‡ÆØ‡Øç‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Neat"] },
    antonyms: { ta: ["‡ÆÖ‡Æ¥‡ØÅ‡Æï‡Øç‡Æï‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Dirty"] }
  },
  {
    ta: "‡Æ™‡ØÅ‡Æ§‡Æø‡ÆØ‡Æ§‡ØÅ",
    en: "New",
    synonyms: { ta: ["‡Æö‡ÆÆ‡ØÄ‡Æ™‡Æ§‡Øç‡Æ§‡Æø‡ÆØ"], en: ["Fresh"] },
    antonyms: { ta: ["‡Æ™‡Æ¥‡Øà‡ÆØ‡Æ§‡ØÅ"], en: ["Old"] }
  },
  {
    ta: "‡Æ®‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ",
    en: "Good",
    synonyms: { ta: ["‡Æö‡Æø‡Æ±‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ", "‡ÆÆ‡Øá‡Æ©‡Øç‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Nice", "Excellent"] },
    antonyms: { ta: ["‡Æï‡ØÜ‡Æü‡Øç‡Æü‡Æ§‡ØÅ"], en: ["Bad"] }
  },
  {
    ta: "‡Æö‡Æ®‡Øç‡Æ§‡Øã‡Æ∑‡ÆÆ‡Øç",
    en: "Happy",
    synonyms: { ta: ["‡ÆÆ‡Æï‡Æø‡Æ¥‡Øç‡Æö‡Øç‡Æö‡Æø", "‡ÆÜ‡Æ©‡Æ®‡Øç‡Æ§‡ÆÆ‡Øç"], en: ["Joyful", "Glad"] },
    antonyms: { ta: ["‡Æö‡Øã‡Æï‡ÆÆ‡Øç"], en: ["Sad"] }
  },
  {
    ta: "‡ÆÖ‡Æ¥‡Æï‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Beautiful",
    synonyms: { ta: ["‡Æá‡Æ©‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Pretty"] },
    antonyms: { ta: ["‡ÆÖ‡Æ¥‡Æï‡Æø‡Æ≤‡Øç‡Æ≤‡Ææ‡Æ§‡Æ§‡ØÅ"], en: ["Ugly"] }
  },
  {
    ta: "‡Æµ‡Æ≤‡ØÅ‡Æµ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Strong",
    synonyms: { ta: ["‡Æâ‡Æ±‡ØÅ‡Æ§‡Æø‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Powerful"] },
    antonyms: { ta: ["‡Æ™‡Æ≤‡Æµ‡ØÄ‡Æ©‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Weak"] }
  },
  {
    ta: "‡Æé‡Æ≥‡Æø‡Æ§‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Easy",
    synonyms: { ta: ["‡Æö‡ØÅ‡Æ≤‡Æ™‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Simple"] },
    antonyms: { ta: ["‡Æï‡Æü‡Æø‡Æ©‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Hard"] }
  },
  {
    ta: "‡ÆÆ‡ØÜ‡Æ©‡Øç‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Soft",
    synonyms: { ta: ["‡Æ®‡ØÜ‡Æï‡Æø‡Æ¥‡Øç‡Æµ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Gentle"] },
    antonyms: { ta: ["‡Æï‡Æü‡Æø‡Æ©‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Hard"] }
  },
  {
    ta: "‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ",
    en: "Cold",
    synonyms: { ta: ["‡Æö‡ØÄ‡Æ§‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Cool"] },
    antonyms: { ta: ["‡Æö‡ØÇ‡Æü‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Hot"] }
  },
  {
    ta: "‡Æâ‡ÆØ‡Æ∞‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Tall",
    synonyms: { ta: ["‡Æ®‡ØÄ‡Æ≥‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["High"] },
    antonyms: { ta: ["‡Æï‡ØÅ‡Æ±‡ØÅ‡Æï‡Æø‡ÆØ"], en: ["Short"] }
  },
  {
    ta: "‡Æµ‡Øá‡Æï‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Quick",
    synonyms: { ta: ["‡Æö‡ØÅ‡Æ±‡ØÅ‡Æö‡ØÅ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Fast"] },
    antonyms: { ta: ["‡ÆÆ‡ØÜ‡Æ§‡ØÅ‡Æµ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Slow"] }
  },
  {
    ta: "‡Æ™‡ØÜ‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡Ææ‡Æ©‡Øç‡ÆÆ‡Øà",
    en: "Many",
    synonyms: { ta: ["‡ÆÖ‡Æ§‡Æø‡Æï‡ÆÆ‡Ææ‡Æ©"], en: ["Several"] },
    antonyms: { ta: ["‡Æï‡ØÅ‡Æ±‡Øà‡Æµ‡Ææ‡Æ©"], en: ["Few"] }
  },
  {
    ta: "‡ÆÆ‡ØÅ‡Æ¥‡ØÅ‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Full",
    synonyms: { ta: ["‡Æ®‡Æø‡Æ±‡Øà‡Æ®‡Øç‡Æ§"], en: ["Complete"] },
    antonyms: { ta: ["‡Æï‡Ææ‡Æ≤‡Æø‡ÆØ‡Ææ‡Æ©"], en: ["Empty"] }
  },
  {
    ta: "‡Æ§‡ØÇ‡ÆØ‡Øç‡ÆÆ‡Øà",
    en: "Pure",
    synonyms: { ta: ["‡Æö‡ØÅ‡Æ§‡Øç‡Æ§‡ÆÆ‡Ææ‡Æ©"], en: ["Clean"] },
    antonyms: { ta: ["‡ÆÆ‡Ææ‡Æö‡Ææ‡Æ©"], en: ["Impure"] }
  },
  {
    ta: "‡Æµ‡ØÜ‡Æ≥‡Æø‡Æö‡Øç‡Æö‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Bright",
    synonyms: { ta: ["‡Æí‡Æ≥‡Æø‡ÆÆ‡Æø‡Æï‡Øç‡Æï"], en: ["Shiny"] },
    antonyms: { ta: ["‡Æá‡Æ∞‡ØÅ‡Æ£‡Øç‡Æü"], en: ["Dark"] }
  },
  {
    ta: "‡Æ™‡Ææ‡Æ§‡ØÅ‡Æï‡Ææ‡Æ™‡Øç‡Æ™‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Safe",
    synonyms: { ta: ["‡Æ™‡Ææ‡Æ§‡ØÅ‡Æï‡Ææ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü"], en: ["Secure"] },
    antonyms: { ta: ["‡ÆÜ‡Æ™‡Æ§‡Øç‡Æ§‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Dangerous"] }
  },
  {
    ta: "‡Æö‡ØÅ‡Æ±‡ØÅ‡Æö‡ØÅ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Active",
    synonyms: { ta: ["‡Æµ‡Øá‡Æï‡ÆÆ‡Ææ‡Æ©"], en: ["Energetic"] },
    antonyms: { ta: ["‡Æö‡Øã‡ÆÆ‡Øç‡Æ™‡Øá‡Æ±‡Æø‡ÆØ‡Ææ‡Æ©"], en: ["Lazy"] }
  },
  {
    ta: "‡ÆÖ‡ÆÆ‡Øà‡Æ§‡Æø‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Quiet",
    synonyms: { ta: ["‡ÆÆ‡Øå‡Æ©‡ÆÆ‡Ææ‡Æ©"], en: ["Silent"] },
    antonyms: { ta: ["‡Æö‡Æ§‡Øç‡Æ§‡ÆÆ‡Ææ‡Æ©"], en: ["Noisy"] }
  }
];


// ================= GLOBAL STATE =================
let category = '';
let list = [];
let i = 0;
let score = 0;
let relationMode = null;
let relationQuizMode = null;
let isRelationQuiz = false;

// ================= HELPERS =================
function show(id){
  ['home','mode','flash','quiz'].forEach(s => document.getElementById(s).classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}

function goHome(){
  relationMode = null;
  relationQuizMode = null;
  isRelationQuiz = false;
  i = 0;
  show('home');
}

function shuffle(a){ return a.sort(() => Math.random() - 0.5); }

// ================= DATA GUARDS =================
function hasCategoryData(){ return Array.isArray(list) && list.length > 0; }
function hasRelationData(){ return Array.isArray(WORD_RELATIONS) && WORD_RELATIONS.length > 0; }

// ================= CATEGORY =================
function selectCategory(c){
  if(!DATA[c]){
    alert('Category data not available');
    return;
  }
  category = c;
  relationMode = null;
  relationQuizMode = null;
  list = DATA[c].map(x => {
    const [t, e] = x.split('|');
    return { ta: t, en: e };
  });
  i = 0;
  modeTitle.textContent = c.toUpperCase();
  show('mode');
}

function selectRelation(type){
  if(!hasRelationData()){
    alert('Word relation data not available');
    return;
  }
  relationMode = type;
  relationQuizMode = type;
  category = '';
  i = 0;
  modeTitle.textContent = type.toUpperCase();
  show('mode');
}

// ================= FLASHCARDS =================
function renderFlashcard(){
  relationMode ? updateRelationCard() : updateCard();
}

function startFlashcards(){
  i = 0;
  show('flash');
  flashTitle.textContent = relationMode ? relationMode.toUpperCase() : category.toUpperCase();
  renderFlashcard();
}

function updateCard(){
  if(!hasCategoryData() || !list[i]) return;
  cardInner.classList.remove('flipped');
  front.textContent = list[i].ta;
  back.textContent = list[i].en;
  counter.textContent = `${i + 1}/${list.length}`;
}

function updateRelationCard(){
  if(!hasRelationData() || !WORD_RELATIONS[i]) return;
  const item = WORD_RELATIONS[i];
  cardInner.classList.remove('flipped');
  front.textContent = `${item.ta} (${item.en})`;
  const arr = relationMode === 'synonyms' ? item.synonyms.ta : item.antonyms.ta;
  back.innerHTML = `${relationMode === 'synonyms' ? 'Synonyms' : 'Antonyms'}:<br>` +
    arr.map(w => '‚Ä¢ ' + w).join('<br>');
  counter.textContent = `${i + 1}/${WORD_RELATIONS.length}`;
}

function next(){
  const max = relationMode ? WORD_RELATIONS.length : list.length;
  if(i < max - 1){ i++; renderFlashcard(); }
}

function prev(){
  if(i > 0){ i--; renderFlashcard(); }
}

function flipCard(){ cardInner.classList.toggle('flipped'); }

// ================= QUIZ =================
function startQuiz(){
  i = 0;
  score = 0;
  show('quiz');

  if(relationQuizMode){
    if(!hasRelationData()) return;
    isRelationQuiz = true;
    quizTitle.textContent = relationQuizMode.toUpperCase() + ' QUIZ';
    loadRelationQuiz();
  } else {
    if(!hasCategoryData()) return;
    isRelationQuiz = false;
    quizTitle.textContent = category.toUpperCase();
    loadQuiz();
  }
}

function loadQuiz(){
  if(!list[i]) return;
  const q = list[i];
  question.textContent = q.ta;
  options.innerHTML = '';
  quizCounter.textContent = `${i + 1}/${list.length}`;

  let answered = false;
  let opts = [
    q.en,
    ...shuffle(list.filter(x => x.en !== q.en)).slice(0, 3).map(x => x.en)
  ];

  shuffle(opts).forEach(o => {
    const b = document.createElement('button');
    b.className = 'opt';
    b.textContent = o;
    b.onclick = () => {
      if(answered) return;
      answered = true;
      document.querySelectorAll('.opt').forEach(btn => btn.disabled = true);
      if(o === q.en){ score++; b.classList.add('correct'); }
      else{
        b.classList.add('wrong');
        document.querySelectorAll('.opt').forEach(btn => {
          if(btn.textContent === q.en) btn.classList.add('correct');
        });
      }
    };
    options.appendChild(b);
  });
}

function loadRelationQuiz(){
  if(!WORD_RELATIONS[i]) return;
  const item = WORD_RELATIONS[i];
  options.innerHTML = '';
  quizCounter.textContent = `${i + 1}/${WORD_RELATIONS.length}`;

  const correctList = relationQuizMode === 'synonyms'
    ? item.synonyms.ta
    : item.antonyms.ta;

  const correct = correctList[0];
  question.textContent = `Choose the ${relationQuizMode.slice(0,-1)} of: ${item.ta}`;

  let distractors = WORD_RELATIONS
    .flatMap(w => [...w.synonyms.ta, ...w.antonyms.ta])
    .filter(w => w !== correct);

  let optionsSet = shuffle([correct, ...shuffle(distractors).slice(0,3)]);
  let answered = false;

  optionsSet.forEach(opt => {
    const btn = document.createElement('button');
    btn.className = 'opt';
    btn.textContent = opt;
    btn.onclick = () => {
      if(answered) return;
      answered = true;
      document.querySelectorAll('.opt').forEach(b => b.disabled = true);
      if(opt === correct){ score++; btn.classList.add('correct'); }
      else{
        btn.classList.add('wrong');
        document.querySelectorAll('.opt').forEach(b => {
          if(b.textContent === correct) b.classList.add('correct');
        });
      }
    };
    options.appendChild(btn);
  });
}

function nextQuiz(){
  const max = isRelationQuiz ? WORD_RELATIONS.length : list.length;
  if(i < max - 1){
    i++;
    isRelationQuiz ? loadRelationQuiz() : loadQuiz();
  } else {
    alert(`Score: ${score}/${max}`);
    goHome();
  }
}

// ================= BASIC SANITY TESTS =================
console.assert(typeof DATA === 'object', 'DATA must be defined');
console.assert(Array.isArray(WORD_RELATIONS), 'WORD_RELATIONS must be an array');


// ================= AUDIO (ENGLISH FALLBACK ‚Äì OPTION 1) =================
let voice = null;
let voicesReady = false;

function loadVoices() {
  const voices = speechSynthesis.getVoices();
  if (!voices || !voices.length) return;

  // Prefer Tamil if ever available, otherwise English (India), then any English
  voice =
    voices.find(v => v.lang === 'ta-IN') ||
    voices.find(v => v.lang === 'en-IN') ||
    voices.find(v => v.lang && v.lang.startsWith('en')) ||
    voices[0] || null;

  voicesReady = true;
}

speechSynthesis.onvoiceschanged = loadVoices;
loadVoices();

function speakText({ taText = '', enText = '' }) {
  if (!taText && !enText) return;

  if (!voicesReady) loadVoices();

  speechSynthesis.cancel();
  const utterance = new SpeechSynthesisUtterance();

  // If Tamil voice exists, speak Tamil
  if (voice && voice.lang === 'ta-IN') {
    utterance.text = taText;
    utterance.lang = 'ta-IN';
  } else {
    // üîë OPTION 1: English meaning fallback
    utterance.text = enText || taText;
    utterance.lang = voice?.lang || 'en-IN';
  }

  if (voice) utterance.voice = voice;
  speechSynthesis.speak(utterance);
}

// Bind buttons safely
(function bindAudioButtons(){
  const speakBtn = document.getElementById('speak');
  const speakQuizBtn = document.getElementById('speakQuiz');

  if (speakBtn) {
    speakBtn.onclick = () => {
      if (relationMode) {
        // Synonyms / Antonyms: speak Tamil word itself
        speakText({ taText: front.textContent, enText: front.textContent });
      } else if (list[i]) {
        // Categories: Tamil shown, English spoken
        speakText({ taText: list[i].ta, enText: list[i].en });
      }
    };
  }

  if (speakQuizBtn) {
    speakQuizBtn.onclick = () => {
      if (isRelationQuiz) {
        speakText({ taText: question.textContent, enText: question.textContent });
      } else if (list[i]) {
        speakText({ taText: question.textContent, enText: list[i].en });
      }
    };
  }
})();

// ================= AUDIO TESTS =================
console.assert('speechSynthesis' in window, 'Web Speech API not supported');
console.assert(typeof SpeechSynthesisUtterance === 'function', 'SpeechSynthesisUtterance missing');

</script>
</body>
</html>
