<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tamil Learning App</title>
  <style>
    body{font-family:Arial,sans-serif;background:#f5f7fa;display:flex;justify-content:center;align-items:center;height:100vh;margin:0}
    .app{background:#fff;padding:20px;border-radius:14px;width:380px;box-shadow:0 10px 25px rgba(0,0,0,.1);text-align:center}
    .hidden{display:none}
    #flashCounter,#quizCounter,#exerciseCounter,#matchCounter{font-size:14px;color:#6b7280;margin-bottom:8px;text-align:right}
    #result h2{margin-bottom:10px}
    #result p{font-size:18px;margin-bottom:20px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:18px}

    /* MATCH UX */
    #match .grid{gap:12px}
    #matchLeft,#matchRight{display:flex;flex-direction:column;gap:10px}
    #matchLeft .opt,#matchRight .opt{width:100%;text-align:center;font-size:16px;padding:12px}
    #matchLeft .opt{background:#eef2ff}
    #matchRight .opt{background:#f0fdf4}
    #match .opt.correct{background:#bbf7d0 !important;animation:fadeOut 0.6s ease forwards}
    #match .opt.wrong{background:#fecaca !important;animation:shake 0.35s ease}

    .mode-grid{display:grid;grid-template-columns:1fr;gap:14px;margin-top:20px}
    .mode-btn{display:flex;align-items:center;justify-content:center;gap:10px;padding:16px;font-size:18px;border-radius:14px}
    .btn{padding:14px;border:none;border-radius:12px;color:#fff;font-size:16px;cursor:pointer}
    .animals{background:#4f46e5}.birds{background:#0284c7}.fruits{background:#16a34a}
    .verbs{background:#ca8a04}.household{background:#0f766e}.grocery{background:#7c3aed}
    .synonyms{background:#9333ea}.antonyms{background:#0ea5e9}
    .card{height:160px;background:#4f46e5;color:#fff;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:28px;cursor:pointer;margin:12px 0}
    .inner{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .6s}
    .inner.flipped{transform:rotateY(180deg)}
    .side{position:absolute;width:100%;height:100%;backface-visibility:hidden;display:flex;align-items:center;justify-content:center}
    .back{background:#16a34a;transform:rotateY(180deg)}
    .options{display:flex;flex-direction:column;gap:10px;margin:14px 0}
    .opt{padding:10px;border-radius:8px;border:1px solid #c7d2fe;background:#eef2ff;color:#1f2937;font-size:15px;cursor:pointer}
    .correct{background:#bbf7d0;color:#065f46}
    .wrong{background:#fecaca;color:#7f1d1d}
    button{padding:8px 14px;border:none;border-radius:8px;background:#4f46e5;color:#fff;cursor:pointer}

    @keyframes shake{
      0%{transform:translateX(0)}
      25%{transform:translateX(-6px)}
      50%{transform:translateX(6px)}
      75%{transform:translateX(-6px)}
      100%{transform:translateX(0)}
    }

    @keyframes fadeOut{
      0%{opacity:1}
      100%{opacity:0.45}
    }
  
    .progress-cards{display:flex;flex-direction:column;gap:12px;margin-top:16px}
    .p-card{display:flex;gap:12px;align-items:center;padding:14px;border-radius:14px}
    .p-card h4{margin:0 0 4px 0}
    .p-card p{margin:2px 0;font-size:14px}
    .p-icon{font-size:28px}
    .p-card.quiz{background:#eef2ff}
    .p-card.exercise{background:#f0fdf4}
    .p-card.match{background:#fff7ed}
  </style>
</head>
<body>
<div class="app">

  <!-- HOME -->
  <div id="home">
    <h2>üìò Tamil Learning</h2>
    <!-- CURRENT PROFILE -->
    <div id="homeProfile" style="margin:8px 0;color:#374151;font-size:14px">
      üë§ <b id="currentProfileName"></b>
      <button
        style="margin-left:8px;padding:4px 10px;font-size:12px;border-radius:8px;background:#e5e7eb;color:#111827"
        onclick="changeProfile()"
      >
        Change
      </button>
    </div>
    <!-- LEVEL INDICATOR -->
    <div id="homeLevel"
        style="margin:6px 0;font-size:14px;color:#374151">
      Level:
      <b id="currentLevelLabel">‚≠ê Beginner</b>
      <button
        style="margin-left:6px;padding:4px 8px;font-size:12px;border-radius:8px;background:#e5e7eb"
        onclick="openLevelSelector()"
      >
        Change
      </button>
    </div>

    <div style="font-size:13px;margin-top:4px" id="homePracticeToday">
            ‚ùå Not practiced today
    </div>
    <!-- HOME PROGRESS SUMMARY -->
    <div id="homeProgress"
        style="margin:10px 0;padding:10px;border-radius:12px;
                background:#f8fafc;color:#111827;text-align:left">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div style="font-size:14px">üî• <b><span id="homeStreak">0</span>-day streak</b></div>
          

          <div style="font-size:13px;margin-top:4px">
            ‚≠ê Best Quiz: <b><span id="homeBestQuiz">0</span></b>
          </div>
        </div>
        <button
          style="padding:6px 10px;border-radius:8px;background:#e5e7eb;color:#111827"
          onclick="openProgress()"
        >
          üìä View
        </button>
      </div>
    </div>

    <p>Select a category</p>
    <div class="grid">
      <button class="btn animals" onclick="selectCategory('animals')">üêæ Animals</button>
      <button class="btn birds" onclick="selectCategory('birds')">üê¶ Birds</button>
      <button class="btn fruits" onclick="selectCategory('fruits')">üçé Fruits</button>
      <button class="btn verbs" onclick="selectCategory('verbs')">üèÉ Verbs</button>
      <button class="btn household" onclick="selectCategory('household')">üè† Household</button>
      <button class="btn grocery" onclick="selectCategory('grocery')">üõí Grocery</button>
      <button class="btn synonyms" onclick="selectRelation('synonyms')">üîÅ Synonyms</button>
      <button class="btn antonyms" onclick="selectRelation('antonyms')">üîÄ Antonyms</button>
    </div>
  </div>

  <!-- MODE -->
  <div id="mode" class="hidden">
    <h3 id="modeTitle"></h3>
    <p>Select learning mode</p>
    <div class="mode-grid">
      <button class="btn animals mode-btn" onclick="startFlashcards()">üÉè Flashcards</button>
      <button class="btn birds mode-btn" onclick="startQuiz()">üß† Quiz</button>
      <button class="btn fruits mode-btn" onclick="startExercise()">‚úèÔ∏è Exercises</button>
      <button class="btn verbs mode-btn" onclick="startMatch()">üß© Match</button>
    </div>
  </div>

  <!-- FLASHCARDS -->
  <div id="flash" class="hidden">
    <div id="flashCounter"></div>
    <button onclick="goHome()">üè† Home</button>
    <div class="card" onclick="flipCard()">
      <div class="inner" id="cardInner">
        <div class="side" id="front"></div>
        <div class="side back" id="back"></div>
      </div>
    </div>
    <button onclick="prev()">Prev</button>
    <button onclick="next()">Next</button>
  </div>

  <!-- QUIZ -->
  <div id="quiz" class="hidden">
    <div id="quizCounter"></div>
    <button onclick="goHome()">üè† Home</button>
    <h3 id="question"></h3>
    <div id="options" class="options"></div>
    <button id="quizNext" onclick="nextQuiz()" disabled>Next</button>
  </div>

  <!-- EXERCISE -->
  <div id="exercise" class="hidden">
    <div id="exerciseCounter"></div>
    <button onclick="goHome()">üè† Home</button>
    <h3 id="exerciseQuestion"></h3>
    <div id="exerciseOptions" class="options"></div>
    <button id="exerciseNext" onclick="nextExercise()" disabled>Next</button>
  </div>

  <!-- MATCH -->
  <div id="match" class="hidden">
    <div id="matchCounter"></div>
    <button onclick="goHome()">üè† Home</button>
    <div class="grid" style="margin-top:16px">
      <div id="matchLeft"></div>
      <div id="matchRight"></div>
    </div>
  </div>

  <!-- RESULT -->
  <div id="result" class="hidden">
    <h2>üéâ Well Done!</h2>
    <p id="resultText"></p>
    <div class="mode-grid">
      <button class="btn fruits mode-btn" onclick="retryActivity()">üîÅ Retry</button>
      <button class="btn birds mode-btn" onclick="openProgress()">üìä Progress</button>
      <button class="btn animals mode-btn" onclick="goHome()">üè† Home</button>
    </div>
  </div>
    <!-- LEVEL SELECTOR -->
  <div id="levelSelector" class="hidden"
     style="position:fixed;inset:0;background:rgba(0,0,0,.4);z-index:10000">
  <div style="background:#fff;padding:20px;border-radius:16px;
              width:280px;margin:20vh auto;text-align:center">
    <h3>Select Level</h3>
    <div id="levelOptions" style="margin-top:14px"></div>
    <button style="margin-top:12px" onclick="closeLevelSelector()">Cancel</button>
  </div>
</div>

  <!-- PROFILE -->
<div id="profile" class="hidden">
  <h2>üë§ Who is learning today?</h2>
  <input
    id="profileName"
    placeholder="Enter name"
    maxlength="12"
    style="padding:10px;width:90%;margin-top:12px;border-radius:10px;border:1px solid #c7d2fe;font-size:16px"
  />
  <button
    class="btn animals mode-btn"
    style="margin-top:16px"
    onclick="confirmProfile()"
  >
    ‚ñ∂ Start Learning
  </button>
</div>

  <!-- PROGRESS -->
  <div id="progress" class="hidden">
 <h2>üìä <span id="profileLabel"></span>‚Äôs Progress</h2>
  <p style="color:#6b7280;margin-top:-6px">Keep going! Every attempt makes you better ‚≠ê</p>
 <div class="p-card streak" style="background:#fff1f2">
  <div class="p-icon">üî•</div>
  <div>
    <h4>Daily Streak</h4>
    <p><b><span id="pStreak">0</span></b> days in a row</p>
  </div>
 </div>





  <div class="progress-cards">
    <div class="p-card quiz">
      <div class="p-icon">üß†</div>
      <div>
        <h4>Quiz</h4>
        <p>Attempts: <b><span id="pQuizAttempts">0</span></b></p>
        <p>Best Score: <b><span id="pQuizBest">0</span></b></p>
      </div>
    </div>

    <div class="p-card exercise">
      <div class="p-icon">‚úèÔ∏è</div>
      <div>
        <h4>Exercise</h4>
        <p>Attempts: <b><span id="pExerciseAttempts">0</span></b></p>
        <p>Best Score: <b><span id="pExerciseBest">0</span></b></p>
      </div>
    </div>

    <div class="p-card match">
      <div class="p-icon">üß©</div>
      <div>
        <h4>Match</h4>
        <p>Attempts: <b><span id="pMatchAttempts">0</span></b></p>
      </div>
    </div>
  </div>

  <div class="mode-grid" style="margin-top:18px">
    <button class="btn birds mode-btn" onclick="changeProfile()">üë§ Change Profile</button>
    <button class="btn animals mode-btn" onclick="goHome()">üè† Home</button>
  </div>
</div>

  
</div>

<script>
  function shuffle(arr){ return arr.slice().sort(()=>Math.random()-0.5); }

  // ===== DATA =====
const DATA={
 animals:['‡Æ®‡Ææ‡ÆØ‡Øç|Dog','‡Æ™‡ØÇ‡Æ©‡Øà|Cat','‡ÆØ‡Ææ‡Æ©‡Øà|Elephant','‡Æö‡Æø‡Æô‡Øç‡Æï‡ÆÆ‡Øç|Lion','‡Æ™‡ØÅ‡Æ≤‡Æø|Tiger','‡ÆÆ‡Ææ‡Æü‡ØÅ|Cow','‡Æï‡ØÅ‡Æ§‡Æø‡Æ∞‡Øà|Horse','‡ÆÜ‡Æü‡ØÅ|Goat','‡Æö‡ØÜ‡ÆÆ‡Øç‡ÆÆ‡Æ±‡Æø‡ÆØ‡Ææ‡Æü‡ØÅ|Sheep','‡Æï‡ØÅ‡Æ∞‡Æô‡Øç‡Æï‡ØÅ|Monkey','‡Æï‡Æ∞‡Æü‡Æø|Bear','‡Æ®‡Æ∞‡Æø|Fox','‡ÆÆ‡Ææ‡Æ©‡Øç|Deer','‡Æí‡Æü‡Øç‡Æü‡Æï‡ÆÆ‡Øç|Camel','‡Æ™‡Æ©‡Øç‡Æ±‡Æø|Pig','‡Æé‡Æ≤‡Æø|Mouse','‡ÆÆ‡ØÅ‡ÆØ‡Æ≤‡Øç|Rabbit','‡Æ®‡ØÄ‡Æ∞‡Øç‡ÆØ‡Ææ‡Æ©‡Øà|Hippopotamus','‡ÆÆ‡ØÅ‡Æ§‡Æ≤‡Øà|Crocodile','‡Æ™‡Ææ‡ÆÆ‡Øç‡Æ™‡ØÅ|Snake'],
 birds:['‡Æï‡Ææ‡Æï‡ÆÆ‡Øç|Crow','‡Æï‡Æø‡Æ≥‡Æø|Parrot','‡ÆÆ‡ÆØ‡Æø‡Æ≤‡Øç|Peacock','‡Æö‡Æø‡Æü‡Øç‡Æü‡ØÅ‡Æï‡Øç‡Æï‡ØÅ‡Æ∞‡ØÅ‡Æµ‡Æø|Sparrow','‡ÆÜ‡Æ®‡Øç‡Æ§‡Øà|Owl','‡Æ™‡ØÅ‡Æ±‡Ææ|Pigeon','‡Æµ‡Ææ‡Æ§‡Øç‡Æ§‡ØÅ|Duck','‡Æï‡Øã‡Æ¥‡Æø|Hen','‡Æö‡Øá‡Æµ‡Æ≤‡Øç|Rooster','‡Æï‡ØÅ‡ÆØ‡Æø‡Æ≤‡Øç|Cuckoo','‡Æ™‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ|Eagle','‡Æï‡Æ¥‡ØÅ‡Æï‡ØÅ|Vulture','‡Æ®‡Ææ‡Æ∞‡Øà|Stork','‡ÆÆ‡ØÄ‡Æ©‡Øç‡Æï‡Øä‡Æ§‡Øç‡Æ§‡Æø|Kingfisher','‡ÆÖ‡Æ©‡Øç‡Æ©‡ÆÆ‡Øç|Swan','‡Æµ‡Ææ‡Æ©‡Øç‡Æï‡Øã‡Æ¥‡Æø|Turkey','‡Æ™‡ØÜ‡Æ©‡Øç‡Æï‡ØÅ‡ÆØ‡Æø‡Æ©‡Øç|Penguin','‡Æ§‡ØÅ‡ÆÆ‡Øç‡Æ™‡Æø|Bulbul','‡ÆÆ‡Øà‡Æ©‡Ææ|Myna','‡Æ®‡Ææ‡Æ∞‡Øà‡ÆÆ‡ØÇ‡Æï‡Øç‡Æï‡ØÅ|Crane'],
 fruits:['‡ÆÜ‡Æ™‡Øç‡Æ™‡Æø‡Æ≥‡Øç|Apple','‡Æµ‡Ææ‡Æ¥‡Øà‡Æ™‡Øç‡Æ™‡Æ¥‡ÆÆ‡Øç|Banana','‡ÆÆ‡Ææ‡ÆÆ‡Øç‡Æ™‡Æ¥‡ÆÆ‡Øç|Mango','‡Æ§‡Æø‡Æ∞‡Ææ‡Æü‡Øç‡Æö‡Øà|Grapes','‡ÆÜ‡Æ∞‡Æû‡Øç‡Æö‡ØÅ|Orange','‡Æé‡Æ≤‡ØÅ‡ÆÆ‡Æø‡Æö‡Øç‡Æö‡Øà|Lemon','‡Æ™‡Æ™‡Øç‡Æ™‡Ææ‡Æ≥‡Æø|Papaya','‡Æï‡Øä‡ÆØ‡Øç‡ÆØ‡Ææ|Guava','‡ÆÆ‡Ææ‡Æ§‡ØÅ‡Æ≥‡Øà|Pomegranate','‡ÆÖ‡Æ©‡Øç‡Æ©‡Ææ‡Æö‡Æø|Pineapple','‡Æ∏‡Øç‡Æü‡Øç‡Æ∞‡Ææ‡Æ™‡ØÜ‡Æ∞‡Æø|Strawberry','‡Æ™‡Øá‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Ææ‡ÆØ‡Øç|Pear','‡Æö‡Æ™‡Øç‡Æ™‡Øã‡Æü‡Øç‡Æü‡Ææ|Sapota','‡Æ®‡Ææ‡Æµ‡Æ±‡Øç‡Æ™‡Æ¥‡ÆÆ‡Øç|Jamun','‡ÆÜ‡ÆÆ‡Æ£‡Æï‡Øç‡Æï‡ØÅ|Fig','‡Æ™‡Æø‡Æ≥‡ÆÆ‡Øç|Plum','‡Æö‡ØÜ‡Æ∞‡Øç‡Æ∞‡Æø|Cherry','‡Æ™‡ØÄ‡Æö‡Øç|Peach','‡Æ™‡Øá‡Æ∞‡Æø‡Æö‡Øç‡Æö‡Øà|Date','‡Æï‡Æø‡Æµ‡Æø|Kiwi'],
 verbs:['‡Æ™‡Æü‡Æø|Read','‡Æé‡Æ¥‡ØÅ‡Æ§‡ØÅ|Write','‡Æì‡Æü‡ØÅ|Run','‡Æ®‡Æü|Walk','‡Æö‡Ææ‡Æ™‡Øç‡Æ™‡Æø‡Æü‡ØÅ|Eat','‡Æï‡ØÅ‡Æü‡Æø|Drink','‡Æ™‡Øá‡Æö‡ØÅ|Speak','‡Æï‡Øá‡Æ≥‡Øç|Listen','‡Æ™‡Ææ‡Æ∞‡Øç|See','‡Æé‡Æü‡ØÅ|Take','‡Æï‡Øä‡Æü‡ØÅ|Give','‡Æµ‡Ææ|Come','‡Æ™‡Øã|Go','‡Æâ‡Æü‡Øç‡Æï‡Ææ‡Æ∞‡Øç|Sit','‡Æ®‡Æø‡Æ≤‡Øç|Stand','‡Æ§‡ØÇ‡Æô‡Øç‡Æï‡ØÅ|Sleep','‡Æé‡Æ¥‡ØÅ|Wake','‡Æµ‡Æø‡Æ≥‡Øà‡ÆØ‡Ææ‡Æü‡ØÅ|Play','‡Æµ‡Øá‡Æ≤‡Øà‡Æö‡ØÜ‡ÆØ‡Øç|Work','‡Æö‡Æø‡Æ®‡Øç‡Æ§‡Æø|Think'],
 household:['‡ÆÆ‡Øá‡Æú‡Øà|Table','‡Æ®‡Ææ‡Æ±‡Øç‡Æï‡Ææ‡Æ≤‡Æø|Chair','‡Æï‡Æü‡Øç‡Æü‡Æø‡Æ≤‡Øç|Bed','‡ÆÖ‡Æ≤‡ÆÆ‡Ææ‡Æ∞‡Æø|Cupboard','‡Æï‡Æ§‡Æµ‡ØÅ|Door','‡Æú‡Æ©‡Øç‡Æ©‡Æ≤‡Øç|Window','‡Æµ‡Æø‡Æ≥‡Æï‡Øç‡Æï‡ØÅ|Lamp','‡ÆÆ‡Æø‡Æ©‡Øç‡Æµ‡Æø‡Æö‡Æø‡Æ±‡Æø|Fan','‡Æü‡Æø‡Æµ‡Æø|Television','‡ÆÉ‡Æ™‡Øç‡Æ∞‡Æø‡Æü‡Øç‡Æú‡Øç|Refrigerator','‡ÆÖ‡Æü‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ|Stove','‡Æ™‡Ææ‡Æ§‡Øç‡Æ§‡Æø‡Æ∞‡ÆÆ‡Øç|Vessel','‡Æï‡Æ∞‡Æ£‡Øç‡Æü‡Æø|Spoon','‡Æ§‡Æü‡Øç‡Æü‡ØÅ|Plate','‡Æï‡Æø‡Æ£‡Øç‡Æ£‡ÆÆ‡Øç|Bowl','‡Æ§‡ØÅ‡Æü‡Øà‡Æ™‡Øç‡Æ™‡ÆÆ‡Øç|Broom','‡Æï‡Æü‡Æø‡Æï‡Ææ‡Æ∞‡ÆÆ‡Øç|Clock','‡Æ§‡Æ≤‡Øà‡ÆØ‡Æ£‡Øà|Pillow','‡Æ™‡Øã‡Æ∞‡Øç‡Æµ‡Øà|Blanket','‡Æ§‡Øä‡Æ≤‡Øà‡Æ™‡Øá‡Æö‡Æø|Telephone'],
 grocery:['‡ÆÖ‡Æ∞‡Æø‡Æö‡Æø|Rice','‡Æï‡Øã‡Æ§‡ØÅ‡ÆÆ‡Øà|Wheat','‡Æö‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æ∞‡Øà|Sugar','‡Æâ‡Æ™‡Øç‡Æ™‡ØÅ|Salt','‡Æé‡Æ£‡Øç‡Æ£‡ØÜ‡ÆØ‡Øç|Oil','‡Æ™‡Ææ‡Æ≤‡Øç|Milk','‡Æ§‡ÆØ‡Æø‡Æ∞‡Øç|Curd','‡Æµ‡ØÜ‡Æ£‡Øç‡Æ£‡ØÜ‡ÆØ‡Øç|Butter','‡ÆÆ‡ØÅ‡Æü‡Øç‡Æü‡Øà|Egg','‡Æ™‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ|Lentils','‡Æï‡Æü‡Æ≤‡Øà|Peanut','‡Æ™‡Ææ‡Æö‡Æø‡Æ™‡Øç‡Æ™‡ÆØ‡Æ±‡ØÅ|Green gram','‡Æâ‡Æ∞‡ØÅ‡Æ≥‡Øà‡Æï‡Øç‡Æï‡Æø‡Æ¥‡Æô‡Øç‡Æï‡ØÅ|Potato','‡Æµ‡ØÜ‡Æô‡Øç‡Æï‡Ææ‡ÆØ‡ÆÆ‡Øç|Onion','‡Æ§‡Æï‡Øç‡Æï‡Ææ‡Æ≥‡Æø|Tomato','‡ÆÆ‡Æø‡Æ≥‡Æï‡Ææ‡ÆØ‡Øç|Chilli','‡ÆÆ‡Æû‡Øç‡Æö‡Æ≥‡Øç|Turmeric','‡ÆÆ‡Æø‡Æ≥‡Æï‡ØÅ|Pepper','‡Æö‡ØÄ‡Æ∞‡Æï‡ÆÆ‡Øç|Cumin','‡Æï‡Øä‡Æ§‡Øç‡Æ§‡ÆÆ‡Æ≤‡Øç‡Æ≤‡Æø|Coriander']
};

// ===== WORD RELATIONS DATA (20 WORDS) =====
const WORD_RELATIONS = [
  {
    ta: "‡Æ™‡ØÜ‡Æ∞‡Æø‡ÆØ‡Æ§‡ØÅ",
    en: "Big",
    synonyms: { ta: ["‡Æµ‡Æø‡Æö‡Ææ‡Æ≤‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ", "‡ÆÆ‡Æø‡Æï‡Æ™‡Øç‡Æ™‡ØÜ‡Æ∞‡Æø‡ÆØ‡Æ§‡ØÅ"], en: ["Large", "Huge"] },
    antonyms: { ta: ["‡Æö‡Æø‡Æ±‡Æø‡ÆØ‡Æ§‡ØÅ"], en: ["Small"] }
  },
  {
    ta: "‡Æµ‡Øá‡Æï‡ÆÆ‡Ææ‡Æï",
    en: "Fast",
    synonyms: { ta: ["‡ÆÖ‡Æ§‡Æø‡Æµ‡Øá‡Æï‡ÆÆ‡Ææ‡Æï"], en: ["Quick"] },
    antonyms: { ta: ["‡ÆÆ‡ØÜ‡Æ§‡ØÅ‡Æµ‡Ææ‡Æï"], en: ["Slow"] }
  },
  {
    ta: "‡Æö‡ØÅ‡Æ§‡Øç‡Æ§‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Clean",
    synonyms: { ta: ["‡Æ§‡ØÇ‡ÆØ‡Øç‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Neat"] },
    antonyms: { ta: ["‡ÆÖ‡Æ¥‡ØÅ‡Æï‡Øç‡Æï‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Dirty"] }
  },
  {
    ta: "‡Æ™‡ØÅ‡Æ§‡Æø‡ÆØ‡Æ§‡ØÅ",
    en: "New",
    synonyms: { ta: ["‡Æö‡ÆÆ‡ØÄ‡Æ™‡Æ§‡Øç‡Æ§‡Æø‡ÆØ"], en: ["Fresh"] },
    antonyms: { ta: ["‡Æ™‡Æ¥‡Øà‡ÆØ‡Æ§‡ØÅ"], en: ["Old"] }
  },
  {
    ta: "‡Æ®‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ",
    en: "Good",
    synonyms: { ta: ["‡Æö‡Æø‡Æ±‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ", "‡ÆÆ‡Øá‡Æ©‡Øç‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Nice", "Excellent"] },
    antonyms: { ta: ["‡Æï‡ØÜ‡Æü‡Øç‡Æü‡Æ§‡ØÅ"], en: ["Bad"] }
  },
  {
    ta: "‡Æö‡Æ®‡Øç‡Æ§‡Øã‡Æ∑‡ÆÆ‡Øç",
    en: "Happy",
    synonyms: { ta: ["‡ÆÆ‡Æï‡Æø‡Æ¥‡Øç‡Æö‡Øç‡Æö‡Æø", "‡ÆÜ‡Æ©‡Æ®‡Øç‡Æ§‡ÆÆ‡Øç"], en: ["Joyful", "Glad"] },
    antonyms: { ta: ["‡Æö‡Øã‡Æï‡ÆÆ‡Øç"], en: ["Sad"] }
  },
  {
    ta: "‡ÆÖ‡Æ¥‡Æï‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Beautiful",
    synonyms: { ta: ["‡Æá‡Æ©‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Pretty"] },
    antonyms: { ta: ["‡ÆÖ‡Æ¥‡Æï‡Æø‡Æ≤‡Øç‡Æ≤‡Ææ‡Æ§‡Æ§‡ØÅ"], en: ["Ugly"] }
  },
  {
    ta: "‡Æµ‡Æ≤‡ØÅ‡Æµ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Strong",
    synonyms: { ta: ["‡Æâ‡Æ±‡ØÅ‡Æ§‡Æø‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Powerful"] },
    antonyms: { ta: ["‡Æ™‡Æ≤‡Æµ‡ØÄ‡Æ©‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Weak"] }
  },
  {
    ta: "‡Æé‡Æ≥‡Æø‡Æ§‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Easy",
    synonyms: { ta: ["‡Æö‡ØÅ‡Æ≤‡Æ™‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Simple"] },
    antonyms: { ta: ["‡Æï‡Æü‡Æø‡Æ©‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Hard"] }
  },
  {
    ta: "‡ÆÆ‡ØÜ‡Æ©‡Øç‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Soft",
    synonyms: { ta: ["‡Æ®‡ØÜ‡Æï‡Æø‡Æ¥‡Øç‡Æµ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Gentle"] },
    antonyms: { ta: ["‡Æï‡Æü‡Æø‡Æ©‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Hard"] }
  },
  {
    ta: "‡Æï‡ØÅ‡Æ≥‡Æø‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ",
    en: "Cold",
    synonyms: { ta: ["‡Æö‡ØÄ‡Æ§‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Cool"] },
    antonyms: { ta: ["‡Æö‡ØÇ‡Æü‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Hot"] }
  },
  {
    ta: "‡Æâ‡ÆØ‡Æ∞‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Tall",
    synonyms: { ta: ["‡Æ®‡ØÄ‡Æ≥‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["High"] },
    antonyms: { ta: ["‡Æï‡ØÅ‡Æ±‡ØÅ‡Æï‡Æø‡ÆØ"], en: ["Short"] }
  },
  {
    ta: "‡Æµ‡Øá‡Æï‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Quick",
    synonyms: { ta: ["‡Æö‡ØÅ‡Æ±‡ØÅ‡Æö‡ØÅ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Fast"] },
    antonyms: { ta: ["‡ÆÆ‡ØÜ‡Æ§‡ØÅ‡Æµ‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Slow"] }
  },
  {
    ta: "‡Æ™‡ØÜ‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡Ææ‡Æ©‡Øç‡ÆÆ‡Øà",
    en: "Many",
    synonyms: { ta: ["‡ÆÖ‡Æ§‡Æø‡Æï‡ÆÆ‡Ææ‡Æ©"], en: ["Several"] },
    antonyms: { ta: ["‡Æï‡ØÅ‡Æ±‡Øà‡Æµ‡Ææ‡Æ©"], en: ["Few"] }
  },
  {
    ta: "‡ÆÆ‡ØÅ‡Æ¥‡ØÅ‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Full",
    synonyms: { ta: ["‡Æ®‡Æø‡Æ±‡Øà‡Æ®‡Øç‡Æ§"], en: ["Complete"] },
    antonyms: { ta: ["‡Æï‡Ææ‡Æ≤‡Æø‡ÆØ‡Ææ‡Æ©"], en: ["Empty"] }
  },
  {
    ta: "‡Æ§‡ØÇ‡ÆØ‡Øç‡ÆÆ‡Øà",
    en: "Pure",
    synonyms: { ta: ["‡Æö‡ØÅ‡Æ§‡Øç‡Æ§‡ÆÆ‡Ææ‡Æ©"], en: ["Clean"] },
    antonyms: { ta: ["‡ÆÆ‡Ææ‡Æö‡Ææ‡Æ©"], en: ["Impure"] }
  },
  {
    ta: "‡Æµ‡ØÜ‡Æ≥‡Æø‡Æö‡Øç‡Æö‡ÆÆ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Bright",
    synonyms: { ta: ["‡Æí‡Æ≥‡Æø‡ÆÆ‡Æø‡Æï‡Øç‡Æï"], en: ["Shiny"] },
    antonyms: { ta: ["‡Æá‡Æ∞‡ØÅ‡Æ£‡Øç‡Æü"], en: ["Dark"] }
  },
  {
    ta: "‡Æ™‡Ææ‡Æ§‡ØÅ‡Æï‡Ææ‡Æ™‡Øç‡Æ™‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Safe",
    synonyms: { ta: ["‡Æ™‡Ææ‡Æ§‡ØÅ‡Æï‡Ææ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü"], en: ["Secure"] },
    antonyms: { ta: ["‡ÆÜ‡Æ™‡Æ§‡Øç‡Æ§‡Ææ‡Æ©‡Æ§‡ØÅ"], en: ["Dangerous"] }
  },
  {
    ta: "‡Æö‡ØÅ‡Æ±‡ØÅ‡Æö‡ØÅ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Active",
    synonyms: { ta: ["‡Æµ‡Øá‡Æï‡ÆÆ‡Ææ‡Æ©"], en: ["Energetic"] },
    antonyms: { ta: ["‡Æö‡Øã‡ÆÆ‡Øç‡Æ™‡Øá‡Æ±‡Æø‡ÆØ‡Ææ‡Æ©"], en: ["Lazy"] }
  },
  {
    ta: "‡ÆÖ‡ÆÆ‡Øà‡Æ§‡Æø‡ÆØ‡Ææ‡Æ©‡Æ§‡ØÅ",
    en: "Quiet",
    synonyms: { ta: ["‡ÆÆ‡Øå‡Æ©‡ÆÆ‡Ææ‡Æ©"], en: ["Silent"] },
    antonyms: { ta: ["‡Æö‡Æ§‡Øç‡Æ§‡ÆÆ‡Ææ‡Æ©"], en: ["Noisy"] }
  }
];


  const QUIZ_TOTAL = 20;
  const EXERCISE_TOTAL = 20;

  let list=[], i=0, score=0, exerciseIndex=0, exerciseOrder=[];


  function show(id){
  ['profile','home','mode','flash','quiz','exercise','match','result','progress']
    .forEach(v => document.getElementById(v).style.display = 'none');
  document.getElementById(id).style.display = 'block';
}


  function goHome(){ show('home'); }

  window.onload = () => {
  if(getProfile()){
    show('home');
    updateHomeLevel();
    updateHomeProfile();
    updateHomeProgress();

  } else {
    show('profile');
  }
};


  function selectCategory(c){
    list = DATA[c].map(x=>{ const[t,e]=x.split('|'); return {ta:t,en:e}; });
    i=0;
    modeTitle.textContent=c;
    show('mode');
  }

  function selectRelation(type){
    list = WORD_RELATIONS.map(w=>({ ta:w.ta, en:type==='synonyms'?w.synonyms.en[0]:w.antonyms.en[0] }));
    i=0;
    modeTitle.textContent=type;
    show('mode');
  }

  function startFlashcards(){ show('flash'); updateCard(); }
  function updateCard(){ front.textContent=list[i].ta; back.textContent=list[i].en; flashCounter.textContent=`${i+1} / ${list.length}`; }
  function next(){ if(i<list.length-1){ i++; updateCard(); } }
  function prev(){ if(i>0){ i--; updateCard(); } }
  function flipCard(){ cardInner.classList.toggle('flipped'); }

  function startQuiz(){ i=0; score=0; show('quiz'); loadQuiz(); }

  function loadQuiz(){
    const q=list[i];
    quizNext.disabled=true;
    quizNext.textContent='Next';
    question.textContent=q.ta;
    quizCounter.textContent=`${i+1} / ${list.length}`;
    options.innerHTML='';
    let answered=false;
    const distractors=list.filter(x=>x.en!==q.en).map(x=>x.en);
    const choices=shuffle([q.en,...shuffle(distractors).slice(0,2)]);
    choices.forEach(choice=>{
      const btn=document.createElement('button');
      btn.className='opt';
      btn.textContent=choice;
      btn.onclick=()=>{
        if(answered) return;
        answered=true;
        quizNext.disabled=false;
        document.querySelectorAll('#options .opt').forEach(b=>b.disabled=true);
        if(choice===q.en){ score++; btn.classList.add('correct'); }
        else{
          btn.classList.add('wrong');
          document.querySelectorAll('#options .opt').forEach(b=>{ if(b.textContent===q.en) b.classList.add('correct'); });
        }
        if(i===list.length-1) quizNext.textContent='Finish';
      };
      options.appendChild(btn);
    });
  }

  function nextQuiz(){
    if(quizNext.disabled) return;
    if(i===list.length-1){if(isNewBest('quiz', score)) showNewBest(); recordQuiz(score);updateStreak();checkLevelUnlock(); showResult(); return; }
    i++; loadQuiz();
  }

  function startExercise(){ exerciseIndex=0; score=0; exerciseOrder=shuffle([...list]); show('exercise'); loadExercise(); }

  function loadExercise(){
    const item=exerciseOrder[exerciseIndex];
    exerciseNext.disabled=true;
    exerciseNext.textContent='Next';
    exerciseQuestion.textContent=`${item.en} = _____`;
    exerciseCounter.textContent=`${exerciseIndex+1} / ${exerciseOrder.length}`;
    exerciseOptions.innerHTML='';
    let answered=false;
    const distractors=list.filter(x=>x.ta!==item.ta).map(x=>x.ta);
    const choices=shuffle([item.ta,...shuffle(distractors).slice(0,2)]);
    choices.forEach(choice=>{
      const btn=document.createElement('button');
      btn.className='opt';
      btn.textContent=choice;
      btn.onclick=()=>{
        if(answered) return;
        answered=true;
        exerciseNext.disabled=false;
        document.querySelectorAll('#exerciseOptions .opt').forEach(b=>b.disabled=true);
        if(choice===item.ta){ score++; btn.classList.add('correct'); }
        else{
          btn.classList.add('wrong');
          document.querySelectorAll('#exerciseOptions .opt').forEach(b=>{ if(b.textContent===item.ta) b.classList.add('correct'); });
        }
        if(exerciseIndex===exerciseOrder.length-1) exerciseNext.textContent='Finish';
      };
      exerciseOptions.appendChild(btn);
    });
  }

  function nextExercise(){
    if(exerciseNext.disabled) return;
    if(exerciseIndex===exerciseOrder.length-1){if(isNewBest('exercise', score)) showNewBest(); recordExercise(score);updateStreak();checkLevelUnlock(); resultText.textContent=`Your score: ${score} / ${exerciseOrder.length}`; show('result'); return; }
    exerciseIndex++; loadExercise();
  }

  function showResult(){ resultText.textContent=`Your score: ${score} / ${list.length}`; show('result'); }

  // MATCH
  let matchPairs=[], selectedLeft=null, selectedRight=null, matchedCount=0;

  function startMatch(){
    matchedCount=0;
    selectedLeft=null; selectedRight=null;
    matchPairs=shuffle([...list]).slice(0,4);
    matchLeft.innerHTML=''; matchRight.innerHTML='';
    matchCounter.textContent=`0 / ${matchPairs.length}`;
    matchPairs.forEach(pair=>{
      const l=document.createElement('button'); l.className='opt'; l.textContent=pair.ta; l.onclick=()=>selectLeft(pair,l); matchLeft.appendChild(l);
    });
    shuffle(matchPairs).forEach(pair=>{
      const r=document.createElement('button'); r.className='opt'; r.textContent=pair.en; r.onclick=()=>selectRight(pair,r); matchRight.appendChild(r);
    });
    show('match');
  }

  function selectLeft(pair,btn){ if(btn.disabled) return; clearSelection('left'); selectedLeft={pair,btn}; btn.classList.add('correct'); checkMatch(); }
  function selectRight(pair,btn){ if(btn.disabled) return; clearSelection('right'); selectedRight={pair,btn}; btn.classList.add('correct'); checkMatch(); }

  function clearSelection(side){
    document.querySelectorAll(side==='left'?'#matchLeft .opt':'#matchRight .opt').forEach(b=>b.classList.remove('correct','wrong'));
  }

  function checkMatch(){
    if(!selectedLeft||!selectedRight) return;
    if(selectedLeft.pair.en===selectedRight.pair.en){
      selectedLeft.btn.disabled=true; selectedRight.btn.disabled=true;
      matchedCount++;
      matchCounter.textContent=`${matchedCount} / ${matchPairs.length}`;
      selectedLeft=null; selectedRight=null;
      if(matchedCount===matchPairs.length){ recordMatch();updateStreak();checkLevelUnlock(); resultText.textContent=`You matched ${matchedCount} / ${matchPairs.length}`; show('result'); }
    } else {
      selectedLeft.btn.classList.add('wrong'); selectedRight.btn.classList.add('wrong');
      setTimeout(()=>{
        selectedLeft.btn.classList.remove('wrong','correct');
        selectedRight.btn.classList.remove('wrong','correct');
        selectedLeft=null; selectedRight=null;
      },600);
    }
  }

  function retryActivity(){ i=0; score=0; show('quiz'); loadQuiz(); }

  function confirmProfile(){
  const input = document.getElementById('profileName');
  const name = input.value.trim();

  if(!/^[a-zA-Z]{2,12}$/.test(name)){
    alert('Please enter a valid name (2‚Äì12 letters)');
    return;
  }

  setProfile(name);
  show('home');
  updateHomeProfile();
  updateHomeProgress();

}

function changeProfile(){
  show('profile');
  document.getElementById('profileName').value = '';
}

function updateHomeProfile(){
  const el = document.getElementById('currentProfileName');
  if(el){
    el.textContent = formatProfileName(getProfile());

  }
}
function formatProfileName(name){
  if(!name) return '';
  return name.charAt(0).toUpperCase() + name.slice(1);
}

function levelKey(){
  return `tamil_level_${getProfile()}`;
}

function getLevelState(){
  const raw = localStorage.getItem(levelKey());
  if(raw) return JSON.parse(raw);

  // default for new profile
  const state = { current: 1, unlocked: [1] };
  localStorage.setItem(levelKey(), JSON.stringify(state));
  return state;
}

function saveLevelState(state){
  localStorage.setItem(levelKey(), JSON.stringify(state));
}

function getCurrentLevel(){
  return getLevelState().current;
}

function setCurrentLevel(level){
  const state = getLevelState();
  if(state.unlocked.includes(level)){
    state.current = level;
    saveLevelState(state);
  }
}

function isLevelUnlocked(level){
  return getLevelState().unlocked.includes(level);
}

function checkLevelUnlock(){
  const progress = getProgress();
  const levelState = getLevelState();
  const current = levelState.current;
  const nextLevel = current + 1;

  // Already unlocked ‚Üí nothing to do
  if(levelState.unlocked.includes(nextLevel)) return false;

  // Practice checks
  if(progress.quiz.attempts < 2) return false;
  if(progress.exercise.attempts < 2) return false;
  if(progress.match.attempts < 1) return false;

  // Mastery checks
  const quizPercent = percent(progress.quiz.best, QUIZ_TOTAL);
  const exercisePercent = percent(progress.exercise.best, EXERCISE_TOTAL);

  if(quizPercent < 70) return false;
  if(exercisePercent < 70) return false;

  // Consistency check
  if(!progress.streak || progress.streak.count < 3) return false;

  // ‚úÖ Unlock next level
  levelState.unlocked.push(nextLevel);
  saveLevelState(levelState);
  showLevelUnlocked(nextLevel);

  return true; // unlocked now
}

function showLevelUnlocked(level){
  const box = document.createElement('div');
  box.innerHTML = `
    üéâ <b>Level ${level} Unlocked!</b><br>
    You can switch levels anytime from Home.
  `;
  box.style.position = 'fixed';
  box.style.top = '50%';
  box.style.left = '50%';
  box.style.transform = 'translate(-50%, -50%)';
  box.style.background = '#ecfeff';
  box.style.color = '#0f172a';
  box.style.padding = '18px 22px';
  box.style.borderRadius = '14px';
  box.style.textAlign = 'center';
  box.style.boxShadow = '0 10px 30px rgba(0,0,0,.2)';
  box.style.zIndex = '10000';

  document.body.appendChild(box);

  setTimeout(() => box.remove(), 2500);
}
function levelName(level){
  if(level === 1) return '‚≠ê Beginner';
  if(level === 2) return '‚≠ê‚≠ê Intermediate';
  if(level === 3) return '‚≠ê‚≠ê‚≠ê Advanced';
  return `Level ${level}`;
}
function updateHomeLevel(){
  document.getElementById('currentLevelLabel')
    .textContent = levelName(getCurrentLevel());
}

function openLevelSelector(){
  const state = getLevelState();
  const box = document.getElementById('levelOptions');
  box.innerHTML = '';

  state.unlocked.forEach(level => {
    const btn = document.createElement('button');
    btn.textContent = levelName(level);
    btn.style.display = 'block';
    btn.style.width = '100%';
    btn.style.margin = '8px 0';
    btn.onclick = () => {
      setCurrentLevel(level);
      updateHomeLevel();
      closeLevelSelector();
    };
    box.appendChild(btn);
  });

  document.getElementById('levelSelector').classList.remove('hidden');
}

function closeLevelSelector(){
  document.getElementById('levelSelector').classList.add('hidden');
}

  /* ===== PROGRESS TRACKING (GLOBAL) ===== */
const PROGRESS_KEY = () => `tamil_progress_${getProfile()}`;


function getProgress(){
  return JSON.parse(localStorage.getItem(PROGRESS_KEY())) || {
    quiz:{attempts:0,best:0},
    exercise:{attempts:0,best:0},
    match:{attempts:0}
  };
}

function saveProgress(p){
  localStorage.setItem(PROGRESS_KEY(), JSON.stringify(p));
}

function percent(score, total){
  if(total === 0) return 0;
  return Math.round((score / total) * 100);
}

function today(){
  return new Date().toISOString().slice(0,10); // YYYY-MM-DD
}

function daysBetween(d1, d2){
  return Math.floor(
    (new Date(d2) - new Date(d1)) / (1000 * 60 * 60 * 24)
  );
}

function practicedToday(){
  const p = getProgress();
  if(!p.streak || !p.streak.lastDate) return false;
  return p.streak.lastDate === today();
}


function updateHomeProgress(){
  const p = getProgress();

  document.getElementById('homeStreak').textContent =
    p.streak ? p.streak.count : 0;

  document.getElementById('homeBestQuiz').textContent =
    p.quiz ? p.quiz.best : 0;

  const practicedEl = document.getElementById('homePracticeToday');
  if(practicedToday()){
    practicedEl.textContent = '‚úÖ Practiced today';
    practicedEl.style.color = '#166534'; // green
  } else {
    practicedEl.textContent = '‚ùå Not practiced today';
    practicedEl.style.color = '#7f1d1d'; // red
  }
}



function updateStreak(){
  const p = getProgress();
  const t = today();

  if(!p.streak){
    p.streak = { count: 1, lastDate: t };
  } else {
    const diff = daysBetween(p.streak.lastDate, t);

    if(diff === 1){
      p.streak.count++;
      p.streak.lastDate = t;
    } else if(diff > 1){
      p.streak.count = 1;
      p.streak.lastDate = t;
    }
    // diff === 0 ‚Üí same day, do nothing
  }

  saveProgress(p);
}

function isNewBest(type, score){
  const p = getProgress();
  return score > (p[type]?.best || 0);
}

function showNewBest(){
  const msg = document.createElement('div');
  msg.textContent = '‚≠ê New Best!';
  msg.style.position = 'fixed';
  msg.style.top = '20px';
  msg.style.left = '50%';
  msg.style.transform = 'translateX(-50%)';
  msg.style.background = '#fde047';
  msg.style.color = '#713f12';
  msg.style.padding = '10px 16px';
  msg.style.borderRadius = '12px';
  msg.style.fontWeight = 'bold';
  msg.style.zIndex = '9999';
  msg.style.boxShadow = '0 6px 18px rgba(0,0,0,.15)';

  document.body.appendChild(msg);
  setTimeout(() => msg.remove(), 3000);
}


function recordQuiz(score){
  const p = getProgress();
  p.quiz.attempts++;
  p.quiz.best = Math.max(p.quiz.best, score);
  saveProgress(p);
}

function recordExercise(score){
  const p = getProgress();
  p.exercise.attempts++;
  p.exercise.best = Math.max(p.exercise.best, score);
  saveProgress(p);
}

function recordMatch(){
  const p = getProgress();
  p.match.attempts++;
  saveProgress(p);
}

/* ===== PROFILE ===== */
let currentProfile = localStorage.getItem('tamil_current_profile');

function setProfile(name){
  currentProfile = name.toLowerCase();
  localStorage.setItem('tamil_current_profile', currentProfile);
}

function getProfile(){
  return currentProfile;
}

function openProgress(){
  document.getElementById('profileLabel').textContent = getProfile();

  const p = getProgress();
  const s = p.streak ? p.streak.count : 0;
  document.getElementById('pStreak').textContent = s;

  document.getElementById('pQuizAttempts').textContent = p.quiz.attempts;
  document.getElementById('pQuizBest').textContent = p.quiz.best;

  document.getElementById('pExerciseAttempts').textContent = p.exercise.attempts;
  document.getElementById('pExerciseBest').textContent = p.exercise.best;

  document.getElementById('pMatchAttempts').textContent = p.match.attempts;

  show('progress');
  updateHomeProgress();
}

  console.assert(typeof selectCategory==='function','selectCategory exists');
</script>
</body>
</html>
