<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tamil Learning App</title>
  <style>
    body{font-family:Arial,sans-serif;background:#f5f7fa;display:flex;justify-content:center;align-items:center;height:100vh;margin:0}
    .app{background:#fff;padding:20px;border-radius:14px;width:380px;box-shadow:0 10px 25px rgba(0,0,0,.1);text-align:center}
    .hidden{display:none}
    #flashCounter,#quizCounter,#exerciseCounter,#matchCounter{font-size:14px;color:#6b7280;margin-bottom:8px;text-align:right}
    #result h2{margin-bottom:10px}
    #result p{font-size:18px;margin-bottom:20px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:18px}

    /* MATCH UX */
    #match .grid{gap:12px}
    #matchLeft,#matchRight{display:flex;flex-direction:column;gap:10px}
    #matchLeft .opt,#matchRight .opt{width:100%;text-align:center;font-size:16px;padding:12px}
    #matchLeft .opt{background:#eef2ff}
    #matchRight .opt{background:#f0fdf4}
    #match .opt.correct{background:#bbf7d0 !important;animation:fadeOut 0.6s ease forwards}
    #match .opt.wrong{background:#fecaca !important;animation:shake 0.35s ease}

    .mode-grid{display:grid;grid-template-columns:1fr;gap:14px;margin-top:20px}
    .mode-btn{display:flex;align-items:center;justify-content:center;gap:10px;padding:16px;font-size:18px;border-radius:14px}
    .btn{padding:14px;border:none;border-radius:12px;color:#fff;font-size:16px;cursor:pointer}
    .animals{background:#4f46e5}.birds{background:#0284c7}.fruits{background:#16a34a}
    .verbs{background:#ca8a04}.household{background:#0f766e}.grocery{background:#7c3aed}
    .synonyms{background:#9333ea}.antonyms{background:#0ea5e9}
    .card{height:160px;background:#4f46e5;color:#fff;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:28px;cursor:pointer;margin:12px 0}
    .inner{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .6s}
    .inner.flipped{transform:rotateY(180deg)}
    .side{position:absolute;width:100%;height:100%;backface-visibility:hidden;display:flex;align-items:center;justify-content:center}
    .back{background:#16a34a;transform:rotateY(180deg)}
    .options{display:flex;flex-direction:column;gap:10px;margin:14px 0}
    .opt{padding:10px;border-radius:8px;border:1px solid #c7d2fe;background:#eef2ff;color:#1f2937;font-size:15px;cursor:pointer}
    .correct{background:#bbf7d0;color:#065f46}
    .wrong{background:#fecaca;color:#7f1d1d}
    button{padding:8px 14px;border:none;border-radius:8px;background:#4f46e5;color:#fff;cursor:pointer}

    @keyframes shake{
      0%{transform:translateX(0)}
      25%{transform:translateX(-6px)}
      50%{transform:translateX(6px)}
      75%{transform:translateX(-6px)}
      100%{transform:translateX(0)}
    }

    @keyframes fadeOut{
      0%{opacity:1}
      100%{opacity:0.45}
    }
  
    .progress-cards{display:flex;flex-direction:column;gap:12px;margin-top:16px}
    .p-card{display:flex;gap:12px;align-items:center;padding:14px;border-radius:14px}
    .p-card h4{margin:0 0 4px 0}
    .p-card p{margin:2px 0;font-size:14px}
    .p-icon{font-size:28px}
    .p-card.quiz{background:#eef2ff}
    .p-card.exercise{background:#f0fdf4}
    .p-card.match{background:#fff7ed}
  </style>
</head>
<body>
<div class="app">

  <!-- HOME -->
  <div id="home">
    <h2>ğŸ“˜ Tamil Learning</h2>
    <!-- CURRENT PROFILE -->
    <div id="homeProfile" style="margin:8px 0;color:#374151;font-size:14px">
      ğŸ‘¤ <b id="currentProfileName"></b>
      <button
        style="margin-left:8px;padding:4px 10px;font-size:12px;border-radius:8px;background:#e5e7eb;color:#111827"
        onclick="changeProfile()"
      >
        Change
      </button>
    </div>
    <div style="font-size:13px;margin-top:4px" id="homePracticeToday">
            âŒ Not practiced today
    </div>
    <!-- HOME PROGRESS SUMMARY -->
    <div id="homeProgress"
        style="margin:10px 0;padding:10px;border-radius:12px;
                background:#f8fafc;color:#111827;text-align:left">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div style="font-size:14px">ğŸ”¥ <b><span id="homeStreak">0</span>-day streak</b></div>
          

          <div style="font-size:13px;margin-top:4px">
            â­ Best Quiz: <b><span id="homeBestQuiz">0</span></b>
          </div>
        </div>
        <button
          style="padding:6px 10px;border-radius:8px;background:#e5e7eb;color:#111827"
          onclick="openProgress()"
        >
          ğŸ“Š View
        </button>
      </div>
    </div>

    <p>Select a category</p>
    <div class="grid">
      <button class="btn animals" onclick="selectCategory('animals')">ğŸ¾ Animals</button>
      <button class="btn birds" onclick="selectCategory('birds')">ğŸ¦ Birds</button>
      <button class="btn fruits" onclick="selectCategory('fruits')">ğŸ Fruits</button>
      <button class="btn verbs" onclick="selectCategory('verbs')">ğŸƒ Verbs</button>
      <button class="btn household" onclick="selectCategory('household')">ğŸ  Household</button>
      <button class="btn grocery" onclick="selectCategory('grocery')">ğŸ›’ Grocery</button>
      <button class="btn synonyms" onclick="selectRelation('synonyms')">ğŸ” Synonyms</button>
      <button class="btn antonyms" onclick="selectRelation('antonyms')">ğŸ”€ Antonyms</button>
    </div>
  </div>

  <!-- MODE -->
  <div id="mode" class="hidden">
    <h3 id="modeTitle"></h3>
    <p>Select learning mode</p>
    <div class="mode-grid">
      <button class="btn animals mode-btn" onclick="startFlashcards()">ğŸƒ Flashcards</button>
      <button class="btn birds mode-btn" onclick="startQuiz()">ğŸ§  Quiz</button>
      <button class="btn fruits mode-btn" onclick="startExercise()">âœï¸ Exercises</button>
      <button class="btn verbs mode-btn" onclick="startMatch()">ğŸ§© Match</button>
    </div>
  </div>

  <!-- FLASHCARDS -->
  <div id="flash" class="hidden">
    <div id="flashCounter"></div>
    <button onclick="goHome()">ğŸ  Home</button>
    <div class="card" onclick="flipCard()">
      <div class="inner" id="cardInner">
        <div class="side" id="front"></div>
        <div class="side back" id="back"></div>
      </div>
    </div>
    <button onclick="prev()">Prev</button>
    <button onclick="next()">Next</button>
  </div>

  <!-- QUIZ -->
  <div id="quiz" class="hidden">
    <div id="quizCounter"></div>
    <button onclick="goHome()">ğŸ  Home</button>
    <h3 id="question"></h3>
    <div id="options" class="options"></div>
    <button id="quizNext" onclick="nextQuiz()" disabled>Next</button>
  </div>

  <!-- EXERCISE -->
  <div id="exercise" class="hidden">
    <div id="exerciseCounter"></div>
    <button onclick="goHome()">ğŸ  Home</button>
    <h3 id="exerciseQuestion"></h3>
    <div id="exerciseOptions" class="options"></div>
    <button id="exerciseNext" onclick="nextExercise()" disabled>Next</button>
  </div>

  <!-- MATCH -->
  <div id="match" class="hidden">
    <div id="matchCounter"></div>
    <button onclick="goHome()">ğŸ  Home</button>
    <div class="grid" style="margin-top:16px">
      <div id="matchLeft"></div>
      <div id="matchRight"></div>
    </div>
  </div>

  <!-- RESULT -->
  <div id="result" class="hidden">
    <h2>ğŸ‰ Well Done!</h2>
    <p id="resultText"></p>
    <div class="mode-grid">
      <button class="btn fruits mode-btn" onclick="retryActivity()">ğŸ” Retry</button>
      <button class="btn birds mode-btn" onclick="openProgress()">ğŸ“Š Progress</button>
      <button class="btn animals mode-btn" onclick="goHome()">ğŸ  Home</button>
    </div>
  </div>
  <!-- PROFILE -->
<div id="profile" class="hidden">
  <h2>ğŸ‘¤ Who is learning today?</h2>
  <input
    id="profileName"
    placeholder="Enter name"
    maxlength="12"
    style="padding:10px;width:90%;margin-top:12px;border-radius:10px;border:1px solid #c7d2fe;font-size:16px"
  />
  <button
    class="btn animals mode-btn"
    style="margin-top:16px"
    onclick="confirmProfile()"
  >
    â–¶ Start Learning
  </button>
</div>

  <!-- PROGRESS -->
  <div id="progress" class="hidden">
 <h2>ğŸ“Š <span id="profileLabel"></span>â€™s Progress</h2>
  <p style="color:#6b7280;margin-top:-6px">Keep going! Every attempt makes you better â­</p>
 <div class="p-card streak" style="background:#fff1f2">
  <div class="p-icon">ğŸ”¥</div>
  <div>
    <h4>Daily Streak</h4>
    <p><b><span id="pStreak">0</span></b> days in a row</p>
  </div>
 </div>





  <div class="progress-cards">
    <div class="p-card quiz">
      <div class="p-icon">ğŸ§ </div>
      <div>
        <h4>Quiz</h4>
        <p>Attempts: <b><span id="pQuizAttempts">0</span></b></p>
        <p>Best Score: <b><span id="pQuizBest">0</span></b></p>
      </div>
    </div>

    <div class="p-card exercise">
      <div class="p-icon">âœï¸</div>
      <div>
        <h4>Exercise</h4>
        <p>Attempts: <b><span id="pExerciseAttempts">0</span></b></p>
        <p>Best Score: <b><span id="pExerciseBest">0</span></b></p>
      </div>
    </div>

    <div class="p-card match">
      <div class="p-icon">ğŸ§©</div>
      <div>
        <h4>Match</h4>
        <p>Attempts: <b><span id="pMatchAttempts">0</span></b></p>
      </div>
    </div>
  </div>

  <div class="mode-grid" style="margin-top:18px">
    <button class="btn birds mode-btn" onclick="changeProfile()">ğŸ‘¤ Change Profile</button>
    <button class="btn animals mode-btn" onclick="goHome()">ğŸ  Home</button>
  </div>
</div>

  
</div>

<script>
  function shuffle(arr){ return arr.slice().sort(()=>Math.random()-0.5); }

  // ===== DATA =====
const DATA={
 animals:['à®¨à®¾à®¯à¯|Dog','à®ªà¯‚à®©à¯ˆ|Cat','à®¯à®¾à®©à¯ˆ|Elephant','à®šà®¿à®™à¯à®•à®®à¯|Lion','à®ªà¯à®²à®¿|Tiger','à®®à®¾à®Ÿà¯|Cow','à®•à¯à®¤à®¿à®°à¯ˆ|Horse','à®†à®Ÿà¯|Goat','à®šà¯†à®®à¯à®®à®±à®¿à®¯à®¾à®Ÿà¯|Sheep','à®•à¯à®°à®™à¯à®•à¯|Monkey','à®•à®°à®Ÿà®¿|Bear','à®¨à®°à®¿|Fox','à®®à®¾à®©à¯|Deer','à®’à®Ÿà¯à®Ÿà®•à®®à¯|Camel','à®ªà®©à¯à®±à®¿|Pig','à®à®²à®¿|Mouse','à®®à¯à®¯à®²à¯|Rabbit','à®¨à¯€à®°à¯à®¯à®¾à®©à¯ˆ|Hippopotamus','à®®à¯à®¤à®²à¯ˆ|Crocodile','à®ªà®¾à®®à¯à®ªà¯|Snake'],
 birds:['à®•à®¾à®•à®®à¯|Crow','à®•à®¿à®³à®¿|Parrot','à®®à®¯à®¿à®²à¯|Peacock','à®šà®¿à®Ÿà¯à®Ÿà¯à®•à¯à®•à¯à®°à¯à®µà®¿|Sparrow','à®†à®¨à¯à®¤à¯ˆ|Owl','à®ªà¯à®±à®¾|Pigeon','à®µà®¾à®¤à¯à®¤à¯|Duck','à®•à¯‹à®´à®¿|Hen','à®šà¯‡à®µà®²à¯|Rooster','à®•à¯à®¯à®¿à®²à¯|Cuckoo','à®ªà®°à¯à®¨à¯à®¤à¯|Eagle','à®•à®´à¯à®•à¯|Vulture','à®¨à®¾à®°à¯ˆ|Stork','à®®à¯€à®©à¯à®•à¯Šà®¤à¯à®¤à®¿|Kingfisher','à®…à®©à¯à®©à®®à¯|Swan','à®µà®¾à®©à¯à®•à¯‹à®´à®¿|Turkey','à®ªà¯†à®©à¯à®•à¯à®¯à®¿à®©à¯|Penguin','à®¤à¯à®®à¯à®ªà®¿|Bulbul','à®®à¯ˆà®©à®¾|Myna','à®¨à®¾à®°à¯ˆà®®à¯‚à®•à¯à®•à¯|Crane'],
 fruits:['à®†à®ªà¯à®ªà®¿à®³à¯|Apple','à®µà®¾à®´à¯ˆà®ªà¯à®ªà®´à®®à¯|Banana','à®®à®¾à®®à¯à®ªà®´à®®à¯|Mango','à®¤à®¿à®°à®¾à®Ÿà¯à®šà¯ˆ|Grapes','à®†à®°à®à¯à®šà¯|Orange','à®à®²à¯à®®à®¿à®šà¯à®šà¯ˆ|Lemon','à®ªà®ªà¯à®ªà®¾à®³à®¿|Papaya','à®•à¯Šà®¯à¯à®¯à®¾|Guava','à®®à®¾à®¤à¯à®³à¯ˆ|Pomegranate','à®…à®©à¯à®©à®¾à®šà®¿|Pineapple','à®¸à¯à®Ÿà¯à®°à®¾à®ªà¯†à®°à®¿|Strawberry','à®ªà¯‡à®°à®¿à®•à¯à®•à®¾à®¯à¯|Pear','à®šà®ªà¯à®ªà¯‹à®Ÿà¯à®Ÿà®¾|Sapota','à®¨à®¾à®µà®±à¯à®ªà®´à®®à¯|Jamun','à®†à®®à®£à®•à¯à®•à¯|Fig','à®ªà®¿à®³à®®à¯|Plum','à®šà¯†à®°à¯à®°à®¿|Cherry','à®ªà¯€à®šà¯|Peach','à®ªà¯‡à®°à®¿à®šà¯à®šà¯ˆ|Date','à®•à®¿à®µà®¿|Kiwi'],
 verbs:['à®ªà®Ÿà®¿|Read','à®à®´à¯à®¤à¯|Write','à®“à®Ÿà¯|Run','à®¨à®Ÿ|Walk','à®šà®¾à®ªà¯à®ªà®¿à®Ÿà¯|Eat','à®•à¯à®Ÿà®¿|Drink','à®ªà¯‡à®šà¯|Speak','à®•à¯‡à®³à¯|Listen','à®ªà®¾à®°à¯|See','à®à®Ÿà¯|Take','à®•à¯Šà®Ÿà¯|Give','à®µà®¾|Come','à®ªà¯‹|Go','à®‰à®Ÿà¯à®•à®¾à®°à¯|Sit','à®¨à®¿à®²à¯|Stand','à®¤à¯‚à®™à¯à®•à¯|Sleep','à®à®´à¯|Wake','à®µà®¿à®³à¯ˆà®¯à®¾à®Ÿà¯|Play','à®µà¯‡à®²à¯ˆà®šà¯†à®¯à¯|Work','à®šà®¿à®¨à¯à®¤à®¿|Think'],
 household:['à®®à¯‡à®œà¯ˆ|Table','à®¨à®¾à®±à¯à®•à®¾à®²à®¿|Chair','à®•à®Ÿà¯à®Ÿà®¿à®²à¯|Bed','à®…à®²à®®à®¾à®°à®¿|Cupboard','à®•à®¤à®µà¯|Door','à®œà®©à¯à®©à®²à¯|Window','à®µà®¿à®³à®•à¯à®•à¯|Lamp','à®®à®¿à®©à¯à®µà®¿à®šà®¿à®±à®¿|Fan','à®Ÿà®¿à®µà®¿|Television','à®ƒà®ªà¯à®°à®¿à®Ÿà¯à®œà¯|Refrigerator','à®…à®Ÿà¯à®ªà¯à®ªà¯|Stove','à®ªà®¾à®¤à¯à®¤à®¿à®°à®®à¯|Vessel','à®•à®°à®£à¯à®Ÿà®¿|Spoon','à®¤à®Ÿà¯à®Ÿà¯|Plate','à®•à®¿à®£à¯à®£à®®à¯|Bowl','à®¤à¯à®Ÿà¯ˆà®ªà¯à®ªà®®à¯|Broom','à®•à®Ÿà®¿à®•à®¾à®°à®®à¯|Clock','à®¤à®²à¯ˆà®¯à®£à¯ˆ|Pillow','à®ªà¯‹à®°à¯à®µà¯ˆ|Blanket','à®¤à¯Šà®²à¯ˆà®ªà¯‡à®šà®¿|Telephone'],
 grocery:['à®…à®°à®¿à®šà®¿|Rice','à®•à¯‹à®¤à¯à®®à¯ˆ|Wheat','à®šà®°à¯à®•à¯à®•à®°à¯ˆ|Sugar','à®‰à®ªà¯à®ªà¯|Salt','à®à®£à¯à®£à¯†à®¯à¯|Oil','à®ªà®¾à®²à¯|Milk','à®¤à®¯à®¿à®°à¯|Curd','à®µà¯†à®£à¯à®£à¯†à®¯à¯|Butter','à®®à¯à®Ÿà¯à®Ÿà¯ˆ|Egg','à®ªà®°à¯à®ªà¯à®ªà¯|Lentils','à®•à®Ÿà®²à¯ˆ|Peanut','à®ªà®¾à®šà®¿à®ªà¯à®ªà®¯à®±à¯|Green gram','à®‰à®°à¯à®³à¯ˆà®•à¯à®•à®¿à®´à®™à¯à®•à¯|Potato','à®µà¯†à®™à¯à®•à®¾à®¯à®®à¯|Onion','à®¤à®•à¯à®•à®¾à®³à®¿|Tomato','à®®à®¿à®³à®•à®¾à®¯à¯|Chilli','à®®à®à¯à®šà®³à¯|Turmeric','à®®à®¿à®³à®•à¯|Pepper','à®šà¯€à®°à®•à®®à¯|Cumin','à®•à¯Šà®¤à¯à®¤à®®à®²à¯à®²à®¿|Coriander']
};

// ===== WORD RELATIONS DATA (20 WORDS) =====
const WORD_RELATIONS = [
  {
    ta: "à®ªà¯†à®°à®¿à®¯à®¤à¯",
    en: "Big",
    synonyms: { ta: ["à®µà®¿à®šà®¾à®²à®®à®¾à®©à®¤à¯", "à®®à®¿à®•à®ªà¯à®ªà¯†à®°à®¿à®¯à®¤à¯"], en: ["Large", "Huge"] },
    antonyms: { ta: ["à®šà®¿à®±à®¿à®¯à®¤à¯"], en: ["Small"] }
  },
  {
    ta: "à®µà¯‡à®•à®®à®¾à®•",
    en: "Fast",
    synonyms: { ta: ["à®…à®¤à®¿à®µà¯‡à®•à®®à®¾à®•"], en: ["Quick"] },
    antonyms: { ta: ["à®®à¯†à®¤à¯à®µà®¾à®•"], en: ["Slow"] }
  },
  {
    ta: "à®šà¯à®¤à¯à®¤à®®à®¾à®©à®¤à¯",
    en: "Clean",
    synonyms: { ta: ["à®¤à¯‚à®¯à¯à®®à¯ˆà®¯à®¾à®©à®¤à¯"], en: ["Neat"] },
    antonyms: { ta: ["à®…à®´à¯à®•à¯à®•à®¾à®©à®¤à¯"], en: ["Dirty"] }
  },
  {
    ta: "à®ªà¯à®¤à®¿à®¯à®¤à¯",
    en: "New",
    synonyms: { ta: ["à®šà®®à¯€à®ªà®¤à¯à®¤à®¿à®¯"], en: ["Fresh"] },
    antonyms: { ta: ["à®ªà®´à¯ˆà®¯à®¤à¯"], en: ["Old"] }
  },
  {
    ta: "à®¨à®²à¯à®²à®¤à¯",
    en: "Good",
    synonyms: { ta: ["à®šà®¿à®±à®¨à¯à®¤à®¤à¯", "à®®à¯‡à®©à¯à®®à¯ˆà®¯à®¾à®©à®¤à¯"], en: ["Nice", "Excellent"] },
    antonyms: { ta: ["à®•à¯†à®Ÿà¯à®Ÿà®¤à¯"], en: ["Bad"] }
  },
  {
    ta: "à®šà®¨à¯à®¤à¯‹à®·à®®à¯",
    en: "Happy",
    synonyms: { ta: ["à®®à®•à®¿à®´à¯à®šà¯à®šà®¿", "à®†à®©à®¨à¯à®¤à®®à¯"], en: ["Joyful", "Glad"] },
    antonyms: { ta: ["à®šà¯‹à®•à®®à¯"], en: ["Sad"] }
  },
  {
    ta: "à®…à®´à®•à®¾à®©à®¤à¯",
    en: "Beautiful",
    synonyms: { ta: ["à®‡à®©à®¿à®®à¯ˆà®¯à®¾à®©à®¤à¯"], en: ["Pretty"] },
    antonyms: { ta: ["à®…à®´à®•à®¿à®²à¯à®²à®¾à®¤à®¤à¯"], en: ["Ugly"] }
  },
  {
    ta: "à®µà®²à¯à®µà®¾à®©à®¤à¯",
    en: "Strong",
    synonyms: { ta: ["à®‰à®±à¯à®¤à®¿à®¯à®¾à®©à®¤à¯"], en: ["Powerful"] },
    antonyms: { ta: ["à®ªà®²à®µà¯€à®©à®®à®¾à®©à®¤à¯"], en: ["Weak"] }
  },
  {
    ta: "à®à®³à®¿à®¤à®¾à®©à®¤à¯",
    en: "Easy",
    synonyms: { ta: ["à®šà¯à®²à®ªà®®à®¾à®©à®¤à¯"], en: ["Simple"] },
    antonyms: { ta: ["à®•à®Ÿà®¿à®©à®®à®¾à®©à®¤à¯"], en: ["Hard"] }
  },
  {
    ta: "à®®à¯†à®©à¯à®®à¯ˆà®¯à®¾à®©à®¤à¯",
    en: "Soft",
    synonyms: { ta: ["à®¨à¯†à®•à®¿à®´à¯à®µà®¾à®©à®¤à¯"], en: ["Gentle"] },
    antonyms: { ta: ["à®•à®Ÿà®¿à®©à®®à®¾à®©à®¤à¯"], en: ["Hard"] }
  },
  {
    ta: "à®•à¯à®³à®¿à®°à¯à®¨à¯à®¤à®¤à¯",
    en: "Cold",
    synonyms: { ta: ["à®šà¯€à®¤à®®à®¾à®©à®¤à¯"], en: ["Cool"] },
    antonyms: { ta: ["à®šà¯‚à®Ÿà®¾à®©à®¤à¯"], en: ["Hot"] }
  },
  {
    ta: "à®‰à®¯à®°à®®à®¾à®©à®¤à¯",
    en: "Tall",
    synonyms: { ta: ["à®¨à¯€à®³à®®à®¾à®©à®¤à¯"], en: ["High"] },
    antonyms: { ta: ["à®•à¯à®±à¯à®•à®¿à®¯"], en: ["Short"] }
  },
  {
    ta: "à®µà¯‡à®•à®®à®¾à®©à®¤à¯",
    en: "Quick",
    synonyms: { ta: ["à®šà¯à®±à¯à®šà¯à®±à¯à®ªà¯à®ªà®¾à®©à®¤à¯"], en: ["Fast"] },
    antonyms: { ta: ["à®®à¯†à®¤à¯à®µà®¾à®©à®¤à¯"], en: ["Slow"] }
  },
  {
    ta: "à®ªà¯†à®°à¯à®®à¯à®ªà®¾à®©à¯à®®à¯ˆ",
    en: "Many",
    synonyms: { ta: ["à®…à®¤à®¿à®•à®®à®¾à®©"], en: ["Several"] },
    antonyms: { ta: ["à®•à¯à®±à¯ˆà®µà®¾à®©"], en: ["Few"] }
  },
  {
    ta: "à®®à¯à®´à¯à®®à¯ˆà®¯à®¾à®©à®¤à¯",
    en: "Full",
    synonyms: { ta: ["à®¨à®¿à®±à¯ˆà®¨à¯à®¤"], en: ["Complete"] },
    antonyms: { ta: ["à®•à®¾à®²à®¿à®¯à®¾à®©"], en: ["Empty"] }
  },
  {
    ta: "à®¤à¯‚à®¯à¯à®®à¯ˆ",
    en: "Pure",
    synonyms: { ta: ["à®šà¯à®¤à¯à®¤à®®à®¾à®©"], en: ["Clean"] },
    antonyms: { ta: ["à®®à®¾à®šà®¾à®©"], en: ["Impure"] }
  },
  {
    ta: "à®µà¯†à®³à®¿à®šà¯à®šà®®à®¾à®©à®¤à¯",
    en: "Bright",
    synonyms: { ta: ["à®’à®³à®¿à®®à®¿à®•à¯à®•"], en: ["Shiny"] },
    antonyms: { ta: ["à®‡à®°à¯à®£à¯à®Ÿ"], en: ["Dark"] }
  },
  {
    ta: "à®ªà®¾à®¤à¯à®•à®¾à®ªà¯à®ªà®¾à®©à®¤à¯",
    en: "Safe",
    synonyms: { ta: ["à®ªà®¾à®¤à¯à®•à®¾à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿ"], en: ["Secure"] },
    antonyms: { ta: ["à®†à®ªà®¤à¯à®¤à®¾à®©à®¤à¯"], en: ["Dangerous"] }
  },
  {
    ta: "à®šà¯à®±à¯à®šà¯à®±à¯à®ªà¯à®ªà®¾à®©à®¤à¯",
    en: "Active",
    synonyms: { ta: ["à®µà¯‡à®•à®®à®¾à®©"], en: ["Energetic"] },
    antonyms: { ta: ["à®šà¯‹à®®à¯à®ªà¯‡à®±à®¿à®¯à®¾à®©"], en: ["Lazy"] }
  },
  {
    ta: "à®…à®®à¯ˆà®¤à®¿à®¯à®¾à®©à®¤à¯",
    en: "Quiet",
    synonyms: { ta: ["à®®à¯Œà®©à®®à®¾à®©"], en: ["Silent"] },
    antonyms: { ta: ["à®šà®¤à¯à®¤à®®à®¾à®©"], en: ["Noisy"] }
  }
];



  let list=[], i=0, score=0, exerciseIndex=0, exerciseOrder=[];


  function show(id){
  ['profile','home','mode','flash','quiz','exercise','match','result','progress']
    .forEach(v => document.getElementById(v).style.display = 'none');
  document.getElementById(id).style.display = 'block';
}


  function goHome(){ show('home'); }

  window.onload = () => {
  if(getProfile()){
    show('home');
    updateHomeProfile();
    updateHomeProgress();

  } else {
    show('profile');
  }
};


  function selectCategory(c){
    list = DATA[c].map(x=>{ const[t,e]=x.split('|'); return {ta:t,en:e}; });
    i=0;
    modeTitle.textContent=c;
    show('mode');
  }

  function selectRelation(type){
    list = WORD_RELATIONS.map(w=>({ ta:w.ta, en:type==='synonyms'?w.synonyms.en[0]:w.antonyms.en[0] }));
    i=0;
    modeTitle.textContent=type;
    show('mode');
  }

  function startFlashcards(){ show('flash'); updateCard(); }
  function updateCard(){ front.textContent=list[i].ta; back.textContent=list[i].en; flashCounter.textContent=`${i+1} / ${list.length}`; }
  function next(){ if(i<list.length-1){ i++; updateCard(); } }
  function prev(){ if(i>0){ i--; updateCard(); } }
  function flipCard(){ cardInner.classList.toggle('flipped'); }

  function startQuiz(){ i=0; score=0; show('quiz'); loadQuiz(); }

  function loadQuiz(){
    const q=list[i];
    quizNext.disabled=true;
    quizNext.textContent='Next';
    question.textContent=q.ta;
    quizCounter.textContent=`${i+1} / ${list.length}`;
    options.innerHTML='';
    let answered=false;
    const distractors=list.filter(x=>x.en!==q.en).map(x=>x.en);
    const choices=shuffle([q.en,...shuffle(distractors).slice(0,2)]);
    choices.forEach(choice=>{
      const btn=document.createElement('button');
      btn.className='opt';
      btn.textContent=choice;
      btn.onclick=()=>{
        if(answered) return;
        answered=true;
        quizNext.disabled=false;
        document.querySelectorAll('#options .opt').forEach(b=>b.disabled=true);
        if(choice===q.en){ score++; btn.classList.add('correct'); }
        else{
          btn.classList.add('wrong');
          document.querySelectorAll('#options .opt').forEach(b=>{ if(b.textContent===q.en) b.classList.add('correct'); });
        }
        if(i===list.length-1) quizNext.textContent='Finish';
      };
      options.appendChild(btn);
    });
  }

  function nextQuiz(){
    if(quizNext.disabled) return;
    if(i===list.length-1){if(isNewBest('quiz', score)) showNewBest(); recordQuiz(score);updateStreak(); showResult(); return; }
    i++; loadQuiz();
  }

  function startExercise(){ exerciseIndex=0; score=0; exerciseOrder=shuffle([...list]); show('exercise'); loadExercise(); }

  function loadExercise(){
    const item=exerciseOrder[exerciseIndex];
    exerciseNext.disabled=true;
    exerciseNext.textContent='Next';
    exerciseQuestion.textContent=`${item.en} = _____`;
    exerciseCounter.textContent=`${exerciseIndex+1} / ${exerciseOrder.length}`;
    exerciseOptions.innerHTML='';
    let answered=false;
    const distractors=list.filter(x=>x.ta!==item.ta).map(x=>x.ta);
    const choices=shuffle([item.ta,...shuffle(distractors).slice(0,2)]);
    choices.forEach(choice=>{
      const btn=document.createElement('button');
      btn.className='opt';
      btn.textContent=choice;
      btn.onclick=()=>{
        if(answered) return;
        answered=true;
        exerciseNext.disabled=false;
        document.querySelectorAll('#exerciseOptions .opt').forEach(b=>b.disabled=true);
        if(choice===item.ta){ score++; btn.classList.add('correct'); }
        else{
          btn.classList.add('wrong');
          document.querySelectorAll('#exerciseOptions .opt').forEach(b=>{ if(b.textContent===item.ta) b.classList.add('correct'); });
        }
        if(exerciseIndex===exerciseOrder.length-1) exerciseNext.textContent='Finish';
      };
      exerciseOptions.appendChild(btn);
    });
  }

  function nextExercise(){
    if(exerciseNext.disabled) return;
    if(exerciseIndex===exerciseOrder.length-1){if(isNewBest('exercise', score)) showNewBest(); recordExercise(score);updateStreak(); resultText.textContent=`Your score: ${score} / ${exerciseOrder.length}`; show('result'); return; }
    exerciseIndex++; loadExercise();
  }

  function showResult(){ resultText.textContent=`Your score: ${score} / ${list.length}`; show('result'); }

  // MATCH
  let matchPairs=[], selectedLeft=null, selectedRight=null, matchedCount=0;

  function startMatch(){
    matchedCount=0;
    selectedLeft=null; selectedRight=null;
    matchPairs=shuffle([...list]).slice(0,4);
    matchLeft.innerHTML=''; matchRight.innerHTML='';
    matchCounter.textContent=`0 / ${matchPairs.length}`;
    matchPairs.forEach(pair=>{
      const l=document.createElement('button'); l.className='opt'; l.textContent=pair.ta; l.onclick=()=>selectLeft(pair,l); matchLeft.appendChild(l);
    });
    shuffle(matchPairs).forEach(pair=>{
      const r=document.createElement('button'); r.className='opt'; r.textContent=pair.en; r.onclick=()=>selectRight(pair,r); matchRight.appendChild(r);
    });
    show('match');
  }

  function selectLeft(pair,btn){ if(btn.disabled) return; clearSelection('left'); selectedLeft={pair,btn}; btn.classList.add('correct'); checkMatch(); }
  function selectRight(pair,btn){ if(btn.disabled) return; clearSelection('right'); selectedRight={pair,btn}; btn.classList.add('correct'); checkMatch(); }

  function clearSelection(side){
    document.querySelectorAll(side==='left'?'#matchLeft .opt':'#matchRight .opt').forEach(b=>b.classList.remove('correct','wrong'));
  }

  function checkMatch(){
    if(!selectedLeft||!selectedRight) return;
    if(selectedLeft.pair.en===selectedRight.pair.en){
      selectedLeft.btn.disabled=true; selectedRight.btn.disabled=true;
      matchedCount++;
      matchCounter.textContent=`${matchedCount} / ${matchPairs.length}`;
      selectedLeft=null; selectedRight=null;
      if(matchedCount===matchPairs.length){ recordMatch();updateStreak(); resultText.textContent=`You matched ${matchedCount} / ${matchPairs.length}`; show('result'); }
    } else {
      selectedLeft.btn.classList.add('wrong'); selectedRight.btn.classList.add('wrong');
      setTimeout(()=>{
        selectedLeft.btn.classList.remove('wrong','correct');
        selectedRight.btn.classList.remove('wrong','correct');
        selectedLeft=null; selectedRight=null;
      },600);
    }
  }

  function retryActivity(){ i=0; score=0; show('quiz'); loadQuiz(); }

  function confirmProfile(){
  const input = document.getElementById('profileName');
  const name = input.value.trim();

  if(!/^[a-zA-Z]{2,12}$/.test(name)){
    alert('Please enter a valid name (2â€“12 letters)');
    return;
  }

  setProfile(name);
  show('home');
  updateHomeProfile();
  updateHomeProgress();

}

function changeProfile(){
  show('profile');
  document.getElementById('profileName').value = '';
}

function updateHomeProfile(){
  const el = document.getElementById('currentProfileName');
  if(el){
    el.textContent = formatProfileName(getProfile());

  }
}
function formatProfileName(name){
  if(!name) return '';
  return name.charAt(0).toUpperCase() + name.slice(1);
}


  /* ===== PROGRESS TRACKING (GLOBAL) ===== */
const PROGRESS_KEY = () => `tamil_progress_${getProfile()}`;


function getProgress(){
  return JSON.parse(localStorage.getItem(PROGRESS_KEY())) || {
    quiz:{attempts:0,best:0},
    exercise:{attempts:0,best:0},
    match:{attempts:0}
  };
}

function saveProgress(p){
  localStorage.setItem(PROGRESS_KEY(), JSON.stringify(p));
}

function today(){
  return new Date().toISOString().slice(0,10); // YYYY-MM-DD
}

function daysBetween(d1, d2){
  return Math.floor(
    (new Date(d2) - new Date(d1)) / (1000 * 60 * 60 * 24)
  );
}

function practicedToday(){
  const p = getProgress();
  if(!p.streak || !p.streak.lastDate) return false;
  return p.streak.lastDate === today();
}


function updateHomeProgress(){
  const p = getProgress();

  document.getElementById('homeStreak').textContent =
    p.streak ? p.streak.count : 0;

  document.getElementById('homeBestQuiz').textContent =
    p.quiz ? p.quiz.best : 0;

  const practicedEl = document.getElementById('homePracticeToday');
  if(practicedToday()){
    practicedEl.textContent = 'âœ… Practiced today';
    practicedEl.style.color = '#166534'; // green
  } else {
    practicedEl.textContent = 'âŒ Not practiced today';
    practicedEl.style.color = '#7f1d1d'; // red
  }
}



function updateStreak(){
  const p = getProgress();
  const t = today();

  if(!p.streak){
    p.streak = { count: 1, lastDate: t };
  } else {
    const diff = daysBetween(p.streak.lastDate, t);

    if(diff === 1){
      p.streak.count++;
      p.streak.lastDate = t;
    } else if(diff > 1){
      p.streak.count = 1;
      p.streak.lastDate = t;
    }
    // diff === 0 â†’ same day, do nothing
  }

  saveProgress(p);
}

function isNewBest(type, score){
  const p = getProgress();
  return score > (p[type]?.best || 0);
}

function showNewBest(){
  const msg = document.createElement('div');
  msg.textContent = 'â­ New Best!';
  msg.style.position = 'fixed';
  msg.style.top = '20px';
  msg.style.left = '50%';
  msg.style.transform = 'translateX(-50%)';
  msg.style.background = '#fde047';
  msg.style.color = '#713f12';
  msg.style.padding = '10px 16px';
  msg.style.borderRadius = '12px';
  msg.style.fontWeight = 'bold';
  msg.style.zIndex = '9999';
  msg.style.boxShadow = '0 6px 18px rgba(0,0,0,.15)';

  document.body.appendChild(msg);
  setTimeout(() => msg.remove(), 3000);
}


function recordQuiz(score){
  const p = getProgress();
  p.quiz.attempts++;
  p.quiz.best = Math.max(p.quiz.best, score);
  saveProgress(p);
}

function recordExercise(score){
  const p = getProgress();
  p.exercise.attempts++;
  p.exercise.best = Math.max(p.exercise.best, score);
  saveProgress(p);
}

function recordMatch(){
  const p = getProgress();
  p.match.attempts++;
  saveProgress(p);
}

/* ===== PROFILE ===== */
let currentProfile = localStorage.getItem('tamil_current_profile');

function setProfile(name){
  currentProfile = name.toLowerCase();
  localStorage.setItem('tamil_current_profile', currentProfile);
}

function getProfile(){
  return currentProfile;
}

function openProgress(){
  document.getElementById('profileLabel').textContent = getProfile();

  const p = getProgress();
  const s = p.streak ? p.streak.count : 0;
  document.getElementById('pStreak').textContent = s;

  document.getElementById('pQuizAttempts').textContent = p.quiz.attempts;
  document.getElementById('pQuizBest').textContent = p.quiz.best;

  document.getElementById('pExerciseAttempts').textContent = p.exercise.attempts;
  document.getElementById('pExerciseBest').textContent = p.exercise.best;

  document.getElementById('pMatchAttempts').textContent = p.match.attempts;

  show('progress');
  updateHomeProgress();
}

  console.assert(typeof selectCategory==='function','selectCategory exists');
</script>
</body>
</html>
